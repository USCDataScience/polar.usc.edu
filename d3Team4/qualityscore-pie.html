<!DOCTYPE html>
<html>
<head>
	<title>Quality Score</title>
	<meta charset="UTF-8">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
	</link>
	<link rel="stylesheet" href="style.css">
	</link>
	<link href='https://fonts.googleapis.com/css?family=Playfair+Display' rel='stylesheet' type='text/css'>	
	</link>
</head>
<body>
	<nav class="navbar navbar-inverse">
		<ul class="navbar-nav">
			<p style="color:white">D3 VISUALIZATION</p>
		</ul>	
	</nav>
	<div class="container row main">
		<div class="container col-md-8">
			<p><b>Frequency of different measurents across the Dataset</b></p>
			<div id="chart" class="container">
			
			</div>
		</div>
		<div class="container col-md-4" id="analysis">
			<p><b>Analysis</b></p>
		</div>
	</div>
	<script type="text/javascript" src="d3.min.js"></script>
	
	<script type="text/javascript">
	function colors_google(n) {
  var colors_g = ["#3366cc", "#dc3912", "#ff9900", "#109618", "#990099", "#0099c6", "#dd4477", "#66aa00", "#b82e2e", "#316395", "#994499", "#22aa99", "#aaaa11", "#6633cc", "#e67300", "#8b0707", "#651067", "#329262", "#5574a6", "#3b3eac", "#ff0000", "#333300", "#006699", "#cc99ff", "#99cc00", "#006600"];
  return colors_g[n % colors_g.length];
}

var height = 400,
	width = 400,
	radius = 200,
	inradius = 100;

var tempColor;
var piedata = [];
d3.json("qualityscore-pie.json",function(error,data){
	for ( var k in data)
	{
		if(data.hasOwnProperty(k)){
			var mimetype = {
				name: k,
				value: data[k]
			}
			piedata.push(mimetype);
		}
	}	
	display_data(piedata);
})

function display_data(piedata)
{
  
	var pie = d3.layout.pie()
    			.value(function(d){
    				return d.value;
    			})

    var arc = d3.svg.arc()
    			.outerRadius(radius)

    var color = d3.scale.category10();

    var info = d3.select('#analysis').append('div')
                    .style('position','absolute')
                    .style('padding','0 10px')
                    .style('background','white')
                    .style('color','black')
                    .style('opacity',0)

    var tooltip = d3.select('#chart').append('div')
    				.style('position','absolute')
    				.style('padding','0 10px')
    				.style('background','white')
    				.style('color','black')
    				.style('opacity',0)

    var mychart = d3.select("#chart").append('svg')
    	.attr('width', width)
    	.attr('height',height)
    	.append('g')
    	.attr('transform','translate('+ (width-radius )+','+ (height -radius) +')')
    	.selectAll('path').data(pie(piedata))
    	.enter()
    		.append('path')
    		.attr('fill',function(d,i){
    			return colors_google(i);	
    		})
    		.attr('d',arc)
    		.on('mouseover',function(d){
    			tooltip.transition()
    				.style('opacity',0.9)
    			tooltip.html('score:'+d.data.name+','+d.data.value+'%')
    				.style('left',d3.event.pageX +'px')
    				.style('top',d3.event.pageY+'px')
                info.transition()
                    .style('opacity',0.9)
                info.html("Percentage of files with a score of \""+d.data.name+"\" = "+d.data.value+"%")
    			tempColor = this.style.fill;
    			d3.select(this)
    				.style('opacity',0.8)
    		})
    		.on('mouseout',function(d){
    			d3.select(this)
    				.style('opacity',1)
    				.style('fill',tempColor)
    		});
}
	</script>
</body>
</html>