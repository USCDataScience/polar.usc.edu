!function(a){function b(){function a(a,c,d){for(var e,f,g,h=([{x:0,y:0},{x:b[0],y:b[1]}],c.x),i=c.y,k=Math.sqrt(b[0]*b[0]+b[1]*b[1]),m=v(b),n=Math.random()<.5?1:-1,o=-n;(e=m(o+=n))&&(f=~~e[0],g=~~e[1],!(Math.min(f,g)>k));)if(c.x=h+f,c.y=i+g,!(c.x+c.x0<0||c.y+c.y0<0||c.x+c.x1>b[0]||c.y+c.y1>b[1])&&(!d||!j(c,a,b[0]))&&(!d||l(c,d))){for(var p,q=c.sprite,r=c.width>>5,s=b[0]>>5,t=c.x-(r<<4),u=127&t,w=32-u,x=c.y1-c.y0,y=(c.y+c.y0)*s+(t>>5),z=0;x>z;z++){p=0;for(var A=0;r>=A;A++)a[y+A]|=p<<w|(r>A?(p=q[z*r+A])>>>u:0);y+=s}return delete c.sprite,!0}return!1}var b=[256,256],n=c,p=d,q=f,r=e,s=e,t=g,u=h,v=m,x=[],y=1/0,z=d3.dispatch("word","end"),A=null,B={};return B.start=function(){function c(){for(var c,l=+new Date;+new Date-l<y&&++g<f&&A;)c=j[g],c.x=b[0]*(Math.random()+.5)>>1,c.y=b[1]*(Math.random()+.5)>>1,i(c,j,g),c.hasText&&a(d,c,e)&&(h.push(c),z.word(c),e?k(e,c):e=[{x:c.x+c.x0,y:c.y+c.y0},{x:c.x+c.x1,y:c.y+c.y1}],c.x-=b[0]>>1,c.y-=b[1]>>1);g>=f&&(B.stop(),z.end(h,e))}var d=o((b[0]>>5)*b[1]),e=null,f=x.length,g=-1,h=[],j=x.map(function(a,b){return a.text=n.call(this,a,b),a.font=p.call(this,a,b),a.style=r.call(this,a,b),a.weight=s.call(this,a,b),a.rotate=t.call(this,a,b),a.size=~~q.call(this,a,b),a.padding=u.call(this,a,b),a}).sort(function(a,b){return b.size-a.size});return A&&clearInterval(A),A=setInterval(c,0),c(),B},B.stop=function(){return A&&(clearInterval(A),A=null),B},B.timeInterval=function(a){return arguments.length?(y=null==a?1/0:a,B):y},B.words=function(a){return arguments.length?(x=a,B):x},B.size=function(a){return arguments.length?(b=[+a[0],+a[1]],B):b},B.font=function(a){return arguments.length?(p=d3.functor(a),B):p},B.fontStyle=function(a){return arguments.length?(r=d3.functor(a),B):r},B.fontWeight=function(a){return arguments.length?(s=d3.functor(a),B):s},B.rotate=function(a){return arguments.length?(t=d3.functor(a),B):t},B.text=function(a){return arguments.length?(n=d3.functor(a),B):n},B.spiral=function(a){return arguments.length?(v=w[a+""]||a,B):v},B.fontSize=function(a){return arguments.length?(q=d3.functor(a),B):q},B.padding=function(a){return arguments.length?(u=d3.functor(a),B):u},d3.rebind(B,z,"on")}function c(a){return a.text}function d(){return"serif"}function e(){return"normal"}function f(a){return Math.sqrt(a.value)}function g(){return 30*(~~(6*Math.random())-3)}function h(){return 1}function i(a,b,c){if(!a.sprite){v.clearRect(0,0,(r<<5)/t,s/t);var d=0,e=0,f=0,g=b.length;for(--c;++c<g;){a=b[c],v.save(),v.font=a.style+" "+a.weight+" "+~~((a.size+1)/t)+"px "+a.font;var h=v.measureText(a.text+"m").width*t,i=a.size<<1;if(a.rotate){var j=Math.sin(a.rotate*q),k=Math.cos(a.rotate*q),l=h*k,m=h*j,n=i*k,o=i*j;h=Math.max(Math.abs(l+o),Math.abs(l-o))+31>>5<<5,i=~~Math.max(Math.abs(m+n),Math.abs(m-n))}else h=h+31>>5<<5;if(i>f&&(f=i),d+h>=r<<5&&(d=0,e+=f,f=0),e+i>=s)break;v.translate((d+(h>>1))/t,(e+(i>>1))/t),a.rotate&&v.rotate(a.rotate*q),v.fillText(a.text,0,0),a.padding&&(v.lineWidth=2*a.padding,v.strokeText(a.text,0,0)),v.restore(),a.width=h,a.height=i,a.xoff=d,a.yoff=e,a.x1=h>>1,a.y1=i>>1,a.x0=-a.x1,a.y0=-a.y1,a.hasText=!0,d+=h}for(var p=v.getImageData(0,0,(r<<5)/t,s/t).data,u=[];--c>=0;)if(a=b[c],a.hasText){for(var h=a.width,w=h>>5,i=a.y1-a.y0,x=0;i*w>x;x++)u[x]=0;if(d=a.xoff,null==d)return;e=a.yoff;for(var y=0,z=-1,A=0;i>A;A++){for(var x=0;h>x;x++){var B=w*A+(x>>5),C=p[(e+A)*(r<<5)+(d+x)<<2]?1<<31-x%32:0;u[B]|=C,y|=C}y?z=A:(a.y0++,i--,A--,e++)}a.y1=a.y0+z,a.sprite=u.slice(0,(a.y1-a.y0)*w)}}}function j(a,b,c){c>>=5;for(var d,e=a.sprite,f=a.width>>5,g=a.x-(f<<4),h=127&g,i=32-h,j=a.y1-a.y0,k=(a.y+a.y0)*c+(g>>5),l=0;j>l;l++){d=0;for(var m=0;f>=m;m++)if((d<<i|(f>m?(d=e[l*f+m])>>>h:0))&b[k+m])return!0;k+=c}return!1}function k(a,b){var c=a[0],d=a[1];b.x+b.x0<c.x&&(c.x=b.x+b.x0),b.y+b.y0<c.y&&(c.y=b.y+b.y0),b.x+b.x1>d.x&&(d.x=b.x+b.x1),b.y+b.y1>d.y&&(d.y=b.y+b.y1)}function l(a,b){return a.x+a.x1>b[0].x&&a.x+a.x0<b[1].x&&a.y+a.y1>b[0].y&&a.y+a.y0<b[1].y}function m(a){var b=a[0]/a[1];return function(a){return[b*(a*=.1)*Math.cos(a),a*Math.sin(a)]}}function n(a){var b=4,c=b*a[0]/a[1],d=0,e=0;return function(a){var f=0>a?-1:1;switch(Math.sqrt(1+4*f*a)-f&3){case 0:d+=c;break;case 1:e+=b;break;case 2:d-=c;break;default:e-=b}return[d,e]}}function o(a){for(var b=[],c=-1;++c<a;)b[c]=0;return b}var p,q=Math.PI/180,r=64,s=2048,t=1;if("undefined"!=typeof document)p=document.createElement("canvas"),p.width=1,p.height=1,t=Math.sqrt(p.getContext("2d").getImageData(0,0,1,1).data.length>>2),p.width=(r<<5)/t,p.height=s/t;else{var u=require("canvas");p=new u(r<<5,s)}var v=p.getContext("2d"),w={archimedean:m,rectangular:n};v.fillStyle=v.strokeStyle="red",v.textAlign="center",a.cloud=b}("undefined"==typeof exports?d3.layout||(d3.layout={}):exports),function(){var a={supportsFullScreen:!1,isFullScreen:function(){return!1},requestFullScreen:function(){},cancelFullScreen:function(){},onScreenSizeChange:function(){},fullScreenEventName:"",prefix:""},b="webkit moz o ms khtml".split(" ");if("undefined"!=typeof document.cancelFullScreen)a.supportsFullScreen=!0;else for(var c=0,d=b.length;d>c;c++)if(a.prefix=b[c],"undefined"!=typeof document[a.prefix+"CancelFullScreen"]){a.supportsFullScreen=!0;break}a.supportsFullScreen&&(a.fullScreenEventName=a.prefix+"fullscreenchange",a.isFullScreen=function(){switch(this.prefix){case"":return document.fullScreen;case"webkit":return document.webkitIsFullScreen;default:return document[this.prefix+"FullScreen"]}},a.requestFullScreen=function(a){return""===this.prefix?a.requestFullScreen():a[this.prefix+"RequestFullScreen"]()},a.cancelFullScreen=function(a){return""===this.prefix?document.cancelFullScreen():document[this.prefix+"CancelFullScreen"]()},a.onScreenSizeChange=function(a){document.addEventListener("fullscreenchange",a,!1),document.addEventListener("webkitfullscreenchange",a,!1),document.addEventListener("mozfullscreenchange",a,!1)}),"undefined"!=typeof jQuery&&(jQuery.fn.requestFullScreen=function(){return this.each(function(){a.supportsFullScreen&&a.requestFullScreen(this)})}),window.fullScreenApi=a}();var gViz=function(){var a=function(){};a.merger=function(){return angular?angular:$};var b={defaultType:"Unknown",vertextIdentifier:"@id",typeIdentifier:"@class"},c={height:500,width:1100,classes:{},node:{r:30},linkDistance:160,charge:-1500,friction:.9,gravity:.5};return a.setup=function(c){a.merger().extend(b,c)},a.configure=function(b){a.merger().extend(c,b)},a.getBehavior=function(){return b},a.getConfigration=function(){return c},a}();gViz.Vertex=function(a){function b(b,c){c instanceof Object?(this[a.vertextIdentifier]=c[a.vertextIdentifier],this.loaded=!0):(this[a.vertextIdentifier]=c,this.loaded=!1),this.source=c,this.graph=b,this.isVertex=!0,b.addClassToCanvas(this.groupIdentifier())}var c=b;c.load=function(a,b){var f=e(a,b);return f?!f.loaded&&b instanceof Object&&(f.source=b,f.loaded=!0):(f=new c(a,b),d(a,f)),f},c.isVertex=function(b){return b instanceof Object?!(b["in"]&&b.out)&&b[a.vertextIdentifier]:!1};var d=function(b,c){e(b,c)||(b.nodes.push(c),g(b,c[a.vertextIdentifier],c))},e=function(a,b){return f(a,h(b))},f=function(a,b){return a.vertices[b]},g=function(a,b,c){a.vertices[b]=c},h=function(b){return b instanceof Object?b[a.vertextIdentifier]:b};return c.prototype.identifier=function(){return h(this)},c.prototype.remove=function(){this.graph.nodes.splice(this.graph.nodes.indexOf(this),1);var a=this.graph.links.filter(function(a){return a.source===this||a.target===this}.bind(this));a.map(function(a){this.graph.links.splice(this.graph.links.indexOf(a),1)}.bind(this)),delete this.graph.vertices[h(this)]},c.prototype.groupIdentifier=function(){return this.source[a.typeIdentifier]||a.defaultType},c.prototype.toJSON=function(){var a={};return a.Id=this.identifier(),a.Name=this.source.name,a.Type=this.groupIdentifier(),a.Loaded=this.loaded,a.Alias=this.source.alias,a},b}(gViz.getBehavior()),gViz.Edge=function(a,b){function c(a,b,c,d){this.graph=a,this.source=b,this.target=c,this.id=e(this.source,this.target),this.left=!1,this.right=!0,this.edge=d,this.label=this.groupIdentifier(),this.isEdge=!0}var d=c;d.load=function(a,d){var e=b.load(a,d.out),f=b.load(a,d["in"]),g=new c(a,e,f,d);return g.add(g),g},d.isEdge=function(a){return a.out&&a["in"]};var e=function(a,b){return a.identifier()+"_"+b.identifier()};return d.prototype.add=function(){var a=this.graph.edges[this.id];a||(this.graph.edges[this.id]=[]);var b=!1;this.graph.edges[this.id].forEach(function(a){a.source==this.source&&a.target==this.target&&(b=!0)}),b||(this.graph.edges[this.id].push(this),this.graph.links.push(this))},d.prototype.remove=function(){this.graph.links.splice(this.graph.links.indexOf(this),1)},d.prototype.similarCount=function(){return this.graph.edges[this.id]?this.graph.edges[this.id].length:0},d.prototype.totalCount=function(){var a=this.graph.edges[e(this.target,this.source)];return this.similarCount()+a?a.length:0},d.prototype.indexInSimilar=function(){return this.graph.edges[this.id].indexOf(this)},d.prototype.groupIdentifier=function(){return this.edge?this.edge[a.typeIdentifier]:a.defaultType},d.prototype.toJSON=function(){var a={};return a.Id=this.id,a.Type=this.groupIdentifier(),a["Source-Id"]=this.source.identifier(),a["Source-Name"]=this.source.source.name,a["Source-Type"]=this.source.groupIdentifier(),a["Target-Id"]=this.source.identifier(),a["Target-Name"]=this.target.source.name,a["Target-Type"]=this.target.groupIdentifier(),a},d.prototype.labelToDisplay=function(){return a.hideLabel?void 0:this.label},c}(gViz.getBehavior(),gViz.Vertex),gViz.EdgeMenu=function(a){function b(b){var c=this;this.graph=b,this.edgeContainer=b.svg.append("svg:g").attr("class","edgeMenu hide");var d=40*b.edgeActions.length;this.tree=a.layout.tree().size([d,50]);var e={name:"",children:b.edgeActions,x:0,y:0,root:!0},f=this.tree.nodes(e),g=this.tree.links(f),h=a.svg.diagonal().projection(function(a){return[a.y,a.x]});this.edgeContainer.selectAll("path.enode-link").data(g).enter().append("svg:path").attr("class","enode-link").attr("d",h),this.nodeGroup=this.edgeContainer.selectAll("g.enode").data(f).enter().append("svg:g").attr("class","enode").attr("transform",function(a){return"translate("+a.y+","+a.x+")"}),this.circle=this.nodeGroup.append("svg:circle").attr("class",function(a){return a.root?"enode-root":"enode-child"}).attr("r",15),this.texts=this.nodeGroup.append("svg:text").attr("text-anchor",function(a){return a.children?"end":"start"}).attr("dy",5).attr("dx",1).text(function(a){return a.name}).on("click",function(b){b.onClick&&(a.event.stopPropagation(),b.onClick(c.selectedEdge.d))})}return b.prototype.select=function(a){var b=this,c=a.elem.getBBox();b.selectedEdge=a,b.edgeContainer.attr("class","edgeMenu"),b.edgeContainer.datum({bbox:c,edge:a.d,elem:a.elem}),b.refreshPosition(),b.graph.menu.hide()},b.prototype.hide=function(){var a=this;a.edgeContainer.attr("class","edgeMenu hide")},b.prototype.refreshPosition=function(){var a=this;a.edgeContainer.attr("transform",function(b){if(b){var c=b.edge,d=b.bbox,e=c.target.x-c.source.x,f=(c.target.y-c.source.y)/(c.target.x-c.source.x),g=((c.target.x+c.source.x)/2,(c.target.y+c.source.y)/2,180*Math.atan(f)/Math.PI);if(g+=90*(0>e?1:-1),a.texts.attr("transform",function(a){return"rotate( "+-g+")"}),!isNaN(g)){var h=-d.width,i=-d.height;if(0>e)var h=d.height/2,i=-d.width;return"rotate("+g+" "+d.x+" "+d.y+") translate("+(d.x+h)+" "+(d.y+i)+")"}}})},b}(d3),gViz.VertexMenu=function(a){function b(b){var c=this;this.graph=b,this.menuContainer=b.svg.append("g"),this.menuContainer.attr("class","menu menu-hide"),this.subSelected=null,this.pie=a.layout.pie().sort(null).value(function(a){return 1}),this.arc=a.svg.arc().innerRadius(0).outerRadius(0),this.menuSel=null;var d=this.menuContainer.selectAll("g").data(this.pie(b.menuActions)).enter().append("g").attr("class","menu-entry").on("click",function(c){a.event.stopPropagation(),c.data.onClick&&c.data.onClick(b.selected)}).on("mouseover",function(d){if(null!=c.menuSel&&c.menuSel!=this&&(a.select(c.menuSel).selectAll("g.treemenu").remove(),a.select(c.menuSel).selectAll("g.submenu").remove()),c.menuSel=this,d.data.submenu){if(d.data.submenu.entries instanceof Function)var e=d.data.submenu.entries(b.selected);else var e=d.data.submenu.entries;if("tree"==d.data.submenu.type){if(!a.select(this).selectAll("g.treemenu").empty()&&c.subSelected==d)return;c.subSelected=d;var f=17*e.length,g=50,h={rtl:{size:[f,g],width:g,offset:2*-g,x:function(a){return 2*g-a.y},xoff:function(a){return g-a.y},y:function(a){return a.x}},ltr:{size:[f,g],width:g,offset:0,x:function(a){return a.y},xoff:function(a){return a.y},y:function(a){return a.x}}},i=d.startAngle>=0&&d.endAngle<=Math.PI?h.ltr:h.rtl,j=a.layout.tree().size(i.size),k=c.arc.centroid(d),l=a.svg.diagonal().projection(function(a){return[a.y,a.x]}),m=0,n={name:d.data.name,children:e,x0:k[0],y0:k[1],root:!0},o=j.nodes(n).reverse(),p=j.links(o);o.forEach(function(a){a.y=a.depth*i.width});var q=a.select(this).append("g").attr("class","treemenu");q.attr("transform",function(a){return"translate("+(k[0]+i.offset)+","+(k[1]-f/2)+")"});var r=q.selectAll("g.treenode").data(o,function(a){return a.id||(a.id=++m)}),s=r.enter().append("g").attr("class",function(a){return a.root?"treenode-root":"treenode"}).attr("transform",function(a){return"translate("+k[1]+","+k[0]+")"}),t=s.append("text").attr("x",function(a){return a.children||a._children?-10:10}).attr("dy",".35em").attr("text-anchor",function(a){return a.children||a._children?"end":"start"}).text(function(a){return a.name}).style("fill-opacity",1e-6).on("click",function(a){a.onClick(b.selected,a.name)}),u=t.node().getBBox(),v=2;s.insert("rect","text").attr("x",u.x-v).attr("y",u.y-v).attr("width",u.width+2*v).attr("height",u.height+2*v).attr("class","tree-text-container");var w=r.transition().duration(750).attr("transform",function(a){return"translate("+i.xoff(a)+","+i.y(a)+")"});w.select("text").style("fill-opacity",1).attr("class","tree-text-menu");var x=q.selectAll("path.treelink").data(p,function(a){return a.target.id});x.enter().insert("path","g").attr("class","treelink").attr("d",function(a){var b={x:k[0],y:k[1]};return l({source:b,target:b})}),x.transition().duration(750).attr("d",a.svg.diagonal().projection(function(a){return[i.x(a),i.y(a)]}))}else{if(!a.select(this).selectAll("g.submenu").empty())return;var y=a.svg.arc().innerRadius(d.innerRadius+40).outerRadius(d.innerRadius),z=a.select(this).append("g").attr("class","submenu"),A=z.selectAll("g").data(c.pie(e)).enter().append("g").attr("class","submenu-entry").on("click",function(c){a.event.stopPropagation(),c.data.onClick&&c.data.onClick(b.selected,c.data.name)});A.append("path").attr("fill",function(a,c){return b.colors(c)}).attr("d",y).attr("id",function(a,b){return"subpath"+b}).attr("class","menu-path"),A.append("text").attr("class","menu-text").attr("transform",function(a){return"translate("+y.centroid(a)+")"}).attr("dy",".35em").text(function(a){return a.data.name})}}}).on("mouseout",function(a){});this.menu=d.append("path").attr("fill",function(a,c){return b.colors(c)}).attr("d",this.arc).attr("class","menu-path"),this.menuText=d.append("text").attr("class","menu-text").attr("transform",function(a){return"translate("+c.arc.centroid(a)+")"}).attr("dy",".35em").text(function(a){return a.data.name})}return b.prototype.hide=function(){var a=this;a.clearSubMenu(),a.menuContainer.attr("class","menu menu-hide")},b.prototype.clearSubMenu=function(){var b=this;null!=b.menuSel&&a.select(b.menuSel).selectAll("g.treemenu").remove()},b.prototype.refreshPosition=function(b,c){function d(c){c.outerRadius=b,c.innerRadius=b+40;var d=a.interpolate({startAngle:0,endAngle:0,outerRadius:0,innerRadius:0},c);return function(a){return e.arc(d(a))}}var e=this;e.menuContainer.attr("transform",function(){return"translate("+e.graph.selected.x+","+e.graph.selected.y+")"}),e.menuContainer.attr("class","menu"),e.arc.innerRadius(b),e.arc.outerRadius(b+40),e.menu.attr("d",e.arc),c&&e.menu.transition().ease("exp-out").duration(500).attr("d",e.arc).each("end",function(a){}).attrTween("d",d),e.menuText.attr("transform",function(a){return"translate("+e.arc.centroid(a)+")"})},b}(d3),gViz.Engine=function(a,b,c,d,e,f,g,h){function i(b){return b?c().extend({},a,b):a}function j(a,b,e,j,k){function l(){x.viewport=h.select(a),x.originElement=a,x.svg,x.config=i(b),x.metadata=c().extend({},e),x.menuActions=j,x.edgeActions=k,x.events={},x.vertices={},x.edges={},x.links=[],x.nodes=[],x.force=h.layout.force(),x.colors=h.scale.category20(),x.selected=null,x.dragNode=null,x.classesInCanvas=[],x.changer=m()}function m(){var a=[];a.display=function(a,b,c){x.config.classes[a]||(x.config.classes[a]={}),x.config.classes[a].display=c,h.selectAll("g.vertex-"+a.toLowerCase()).selectAll(".vlabel").attr("class","vlabel").text(v)},a.icon=function(a,b,c){x.config.classes[a]||(x.config.classes[a]={}),x.config.classes[a].icon=c,h.selectAll("g.vertex-"+a.toLowerCase()).selectAll(".vlabel").attr("class","vlabel vicon").attr("y",6).text(c)};var b=function(a,b,c){x.config.classes[a]||(x.config.classes[a]={}),x.config.classes[a][b]=c,h.selectAll("g.vertex-"+a.toLowerCase()).selectAll(".vcircle").style(b,c),h.selectAll("g.legend-"+a.toLowerCase()).selectAll("circle").style(b,c)};return a.fill=b,a.stroke=b,a.r=function(a,b,c){x.config.classes[a]||(x.config.classes[a]={}),x.config.classes[a][b]=c,h.selectAll("g.vertex-"+a.toLowerCase()).selectAll(".vcircle").attr("r",q),x.setSelected(x.selected)},a}function n(){x.dragNode&&(x.dragNode=null,x.drag_line.classed("hidden",!0).style("marker-end",""))}function o(a){a.elem=this;var b=a.groupIdentifier(),c=x.getClazzConfigVal(b,"css"),d="vertex ";return b&&(d+="vertex-"+b.toLowerCase()),c?d+" "+c:d}function p(){function a(a){function c(a,b){return Math.sqrt(Math.pow(a[0]-b[0],2),Math.pow(a[1]-b[1],2))}var d,e,f=5,g=null;a.on("mousedown",function(){d=h.mouse(document.body),e=+new Date}),a.on("mouseup",function(a){c(d,h.mouse(document.body))>f||(g?(window.clearTimeout(g),g=null,b.dblclick(h.event,a)):g=window.setTimeout(function(c){return function(){b.click(c,a),g=null}}(h.event),300))})}var b=h.dispatch("click","dblclick");return h.rebind(a,b,"on")}function q(a){var b=x.getClazzConfigVal(a.groupIdentifier(),"r");return b||a.source.size||x.getConfigVal("node").r}function r(a){return a.loaded?"1":"0.5"}function s(a){var b=a.groupIdentifier(),c=x.getClazzConfigVal(b,"fill");return c||(c=h.rgb(x.colors(b.toString(2))).toString(),x.changeClazzConfig(b,"fill",c)),c}function t(a){var b=a.groupIdentifier(),c=x.getClazzConfigVal(b,"stroke");return c||(c=h.rgb(x.colors(b.toString(2))).darker().toString(),x.changeClazzConfig(b,"stroke",c)),c}function u(a){return a.loaded?"0":"5,5"}function v(a){var b=x.getClazzConfigVal(a.groupIdentifier(),"icon");return b||(b=x.getClazzConfigVal(a.groupIdentifier(),"display",a.source)),b||a.identifier()}function w(a){if(x.selected){var b=parseInt(q(x.selected));x.menu.refreshPosition(b,a)}}var x=this;this.addClassToCanvas=function(a){-1==this.classesInCanvas.indexOf(a)&&this.classesInCanvas.push(a)},this.toggleLegend=function(){var a=h.select(this.classesContainer.node().parentNode),b=a.attr("class");-1!=b.indexOf("hide")?a.attr("class","legend-container"):a.attr("class","legend-container hide")},this.fullScreen=function(a){var b=function(){if(window.fullScreenApi.isFullScreen()){var a=$(document).height(),b=$(document).width();this.svgContainer.attr("height",a).attr("width",b)}else this.svgContainer.attr("height",x.config.height).attr("width",x.config.width)}.bind(this);window.fullScreenApi.onScreenSizeChange(b),$(a).requestFullScreen()},this.setSelected=function(a){var b=a!=x.selected;x.selected=a,w(b),x.edgeMenu.hide()},this.clearGraph=function(){x.clearSelection(),x.vertices={},x.edges={},x.classesInCanvas=[],x.nodes.splice(0,x.nodes.length),x.links.splice(0,x.links.length)},this.inititalize=function(){var a=this;this.force.nodes(this.nodes).links(this.links).size([this.config.width,this.config.height]).linkDistance(this.config.linkDistance).charge(this.config.charge).friction(this.config.friction);var b=100,c=60,d=1e3/c,e=function(){return Date.now()},i=this.force.tick;this.force.tick=function(){var c=e();for(step=b;step--&&e()-c<d;)if(i())return b=2,!0;var f=Math.floor(100*Math.random()+1);return f%2==0&&a.tick(),!1},this.svgContainer=this.viewport.append("svg"),this.svgContainer.append("svg:defs").append("svg:marker").attr("id","end-arrow").attr("viewBox","0 -5 10 10").attr("refX",6).attr("markerWidth",3).attr("markerHeight",3).attr("orient","auto").append("svg:path").attr("d","M0,-5L10,0L0,5").attr("fill","#000").attr("class","end-arrow"),this.svgContainer.append("svg:defs").append("svg:marker").attr("id","start-arrow").attr("viewBox","0 -5 10 10").attr("refX",4).attr("markerWidth",3).attr("markerHeight",3).attr("orient","auto").append("svg:path").attr("d","M10,-5L0,0L10,5").attr("class","end-arrow"),this.svgContainer.append("svg:defs").append("svg:marker").attr("id","end-arrow-hover").attr("viewBox","0 -5 10 10").attr("refX",6).attr("markerWidth",3).attr("markerHeight",3).attr("orient","auto").append("svg:path").attr("d","M0,-5L10,0L0,5").attr("class","end-arrow-hover"),this.svgContainer.append("svg:defs").append("svg:marker").attr("id","start-arrow-hover").attr("viewBox","0 -5 10 10").attr("refX",4).attr("markerWidth",3).attr("markerHeight",3).attr("orient","auto").append("svg:path").attr("d","M10,-5L0,0L10,5").attr("fill","#000").attr("class","end-arrow-hover"),this.svg=this.svgContainer.attr("width",a.config.width).attr("height",a.config.height).append("g"),this.drag_line=this.svg.append("svg:path").attr("class","link dragline hidden").attr("d","M0,0L0,0"),this.svgContainer.on("click",function(){a.clearSelection(),n()}),this.svgContainer.on("mousemove",function(){a.dragNode&&a.drag_line.attr("d","M"+a.dragNode.x+","+a.dragNode.y+"L"+h.mouse(a.svg.node())[0]+","+h.mouse(a.svg.node())[1])}),this.circleSelected=this.svg.append("svg:g").append("svg:circle").attr("class","selected-vertex selected-vertex-none").attr("r",this.getConfigVal("node").r+3),this.classesContainer=this.svgContainer.append("svg:g").attr("class","legend-container").attr("transform",function(){return"translate(30,30)"}).selectAll("g"),this.path=this.svg.append("svg:g").selectAll("g"),this.circle=this.svg.append("svg:g").selectAll("g"),a.menuActions&&(this.menu=new f(this)),a.edgeActions&&(this.edgeMenu=new g(this))},this.clearSelection=function(){x.selected=null,x.menu.hide(),x.edgeMenu.hide()},this.startEdgeCreation=function(){this.dragNode=x.selected,this.clearSelection(),this.drag_line.style("marker-end","url(#end-arrow)").classed("hidden",!1).attr("d","M"+this.dragNode.x+","+this.dragNode.y+"L"+this.dragNode.x+","+this.dragNode.y)},this.endEdgeCreation=function(){this.clearSelection(),n(),x.drag_line.classed("hidden",!0).style("marker-end","")},this.drawInternal=function(){var a=this;this.path=this.path.data(this.links),this.circle=this.circle.data(this.nodes,function(a){return a.identifier()}),this.classesContainer=this.classesContainer.data(this.classesInCanvas),this.clsLegend=this.classesContainer.enter().append("svg:g").attr("class",function(a){return"legend legend-"+a.toLowerCase()}),this.classesContainer.exit().remove(),this.clsLegend.attr("transform",function(a,b){return"translate(0,"+25*b+")"}),this.clsLegend.append("circle").attr("r",10).attr("y",function(a,b){}).style("fill",function(b){var c=a.getClazzConfigVal(b,"fill");return c?c:null}).style("stroke",function(b){var c=a.getClazzConfigVal(b,"stroke");return c?c:null});var b=this.clsLegend.append("text").attr("dy",5).text(function(a){return a});b.each(function(){var a=15;h.select(this).attr("dx",a)}),this.pathG=this.path.enter().append("svg:g").attr("class",function(a){return"edge-path"}),this.edgePath=this.pathG.append("svg:path").attr("class",function(a){var b=a.edge?"edge":"edge lightweight";return b}).attr("id",function(a,b){return"linkId_"+b}).style("marker-start",function(a){return a.left?"url(#start-arrow)":""}).style("marker-end",function(a){return a.right?"url(#end-arrow)":""}),this.pathG.append("svg:text").attr("class",function(a){return"elabel"}).on("mouseover",function(){h.select(this.parentNode).selectAll(".edge").attr("class",function(a){var b=a.edge?"edge":"edge lightweight";return b+" edge-hover"}).style("marker-start",function(a){return a.left?"url(#start-arrow-hover)":""}).style("marker-end",function(a){return a.right?"url(#end-arrow-hover)":""})}).on("mouseout",function(){h.select(this.parentNode).selectAll(".edge").attr("class",function(a){var b=a.edge?"edge":"edge lightweight";return b}).style("marker-start",function(a){return a.left?"url(#start-arrow)":""}).style("marker-end",function(a){return a.right?"url(#end-arrow)":""})}).style("text-anchor","middle").attr("dy","-5").append("textPath").attr("startOffset","50%").attr("xlink:href",function(a,b){return"#linkId_"+b}).text(function(a){return a.labelToDisplay()}).on("click",function(b){h.event.stopPropagation(),a.edgeMenu.select({elem:this,d:b}),a.events["edge/click"]&&a.events["edge/click"](b)}),this.path.exit().remove();var c=this.circle.enter().append("svg:g").attr("class",o);c.on("mouseover",function(b){if(a.dragNode){var c=q(b),d=c+20*c/100;h.select(b.elem).selectAll("circle").attr("r",d)}}),c.on("mouseout",function(b){a.dragNode&&h.select(b.elem).selectAll("circle").attr("r",q)});var e=this.force.drag();e.on("dragstart",function(a){h.event.sourceEvent.stopPropagation(),h.select(this).classed("dragging",!0),h.select(this).classed("fixed",a.fixed)}),e.on("dragend",function(a){h.event.sourceEvent.stopPropagation(),h.select(this).classed("dragging",!1)}),c.call(e);var f=p();c.on("dblclick",function(){h.event.stopPropagation()}),c.call(f),c.on("click",function(b){a.dragNode&&a.events["edge/create"]&&(a.events["edge/create"](a.dragNode,b),h.event.stopPropagation(),a.dragNode=null)}),f.on("click",function(b,c){a.events["node/click"]&&(c.loaded?a.events["node/click"](c):a.events["node/load"]&&a.events["node/load"](c,function(b){d.isVertex(b)&&(c.loaded=!0,c.source=b,h.select(c.elem).attr("class",o),h.select(c.elem).selectAll("circle").attr("stroke-dasharray",u).attr("fill-opacity",r).attr("r",q),a.events["node/click"](c))}),a.setSelected(c))}),f.on("dblclick",function(b,c){a.events["node/dblclick"]&&a.events["node/dblclick"](c)}),c.append("svg:circle").attr("class","vcircle").attr("r",q).attr("stroke-dasharray",u).attr("fill-opacity",r).style("fill",s).style("stroke",t),c.append("svg:text").attr("x",0).attr("y",function(b){var c=a.getClazzConfigVal(b.groupIdentifier(),"icon");return c?6:4}).attr("class",function(b){var c=a.getClazzConfigVal(b.groupIdentifier(),"icon");return"vlabel"+(c?" vicon":"")}).text(v),this.circle.exit().remove(),this.viewport.call(h.behavior.zoom().scaleExtent([.1,5]).on("zoom",this.zoom))},this.changeClazzConfig=function(a,b,c){this.changer[b]&&this.changer[b](a,b,c)},this.getClazzConfigVal=function(a,b,c){return a&&b&&x.config.classes&&x.config.classes[a]&&x.config.classes[a][b]?c?c[x.config.classes[a][b]]:x.config.classes[a][b]:null},this.getConfig=function(){return this.config},this.getClazzConfig=function(a){return x.config.classes||(x.config.classes={}),x.config.classes[a]||(x.config.classes[a]={}),c().extend({},x.config.classes[a])},this.getConfigVal=function(a){return x.config[a]},this.zoom=function(){var a=h.event.scale,b=h.event.translate;x.svg.attr("transform","translate("+b+") scale("+a+")")},this.tick=function(){function a(a){switch(a){case 2:return{source:Math.PI/6,target:5*Math.PI/6};case 3:return{source:Math.PI/3,target:2*Math.PI/3};case 4:return{source:Math.PI/2,target:Math.PI/2}}}var b=x.path.selectAll("path.edge");b.attr("d",function(){var b=h.select(this.parentNode).datum(),c=x.getClazzConfigVal(b.source.groupIdentifier(),"r"),d=x.getClazzConfigVal(b.target.groupIdentifier(),"r");c=c?c:x.getConfigVal("node").r,d=d?d:x.getConfigVal("node").r,d=parseInt(d),c=parseInt(c);var e=b.target.x-b.source.x,f=b.target.y-b.source.y,g=Math.sqrt(e*e+f*f),i=e/g,j=f/g,k=b.left?c+5:c,l=b.right?d+5:d,m=b.source.x+k*i,n=b.source.y+k*j,o=b.target.x-l*i,p=b.target.y-l*j,q=b.totalCount();if(1==q)return"M"+m+","+n+" L"+o+","+p;var r=b.indexInSimilar();if(0==r){var s=5,t=5;return e>0&&(s=-5,t=-5),"M"+(m+s)+","+(n+s)+" L"+(o+t)+","+(p+t)}var u,v,w,y,z,A,B=r+1,C=(b.target.y-b.source.y)/(b.target.x-b.source.x),D=180*Math.atan(C)/Math.PI,E=D*(Math.PI/180)*-1,F=a(B);0>e?(w=1,y=1,z=1,A=1,u=F.target-E,v=F.source-E):(w=1,y=-1,z=1,A=-1,u=F.source+E,v=F.target+E),m=b.source.x+w*(k*Math.cos(u)),n=b.source.y+y*(k*Math.sin(u)),o=b.target.x+z*(l*Math.cos(v)),p=b.target.y+A*(l*Math.sin(v));var G=70;return"M"+m+","+n+"A"+G+","+G+" 0 0,1 "+o+","+p}),x.edgeMenu&&x.edgeMenu.refreshPosition(),x.circle.attr("transform",function(a){return"translate("+a.x+","+a.y+")"}),w()},l()}var k={};return j.prototype={on:function(a,b){return this.events[a]=b,this},off:function(a){return this.events[a]=null,this},data:function(a){if(!a)return this;var b=a?angular.copy(a):[];return this.lastDataSize=b.length,b.forEach(function(a){if(d.isVertex(a)){d.load(this,a)}else e.isEdge(a)&&e.load(this,a)}.bind(this)),this},removeVertex:function(a){a.remove(),this.clearSelection(),this.redraw()},removeEdge:function(a){a.remove(),this.clearSelection(),this.redraw()},draw:function(){this.inititalize(),this.redraw()},toggleLegend:function(){this.toggleLegendInternal()},update:function(a,b,c){var d=a.filter(function(a){return!(a.x&&a.y)}),e=d.length;d.forEach(function(a,d,f){a.x=b.x+c*Math.sin(2*Math.PI*d/e),a.y=b.y+c*Math.cos(2*Math.PI*d/e)})},redraw:function(){this.drawInternal(),this.clearSelection();var a=this.nodes.length*this.config.linkDistance/(2*Math.PI),b={x:this.config.width/2,y:this.config.height/2};this.update(this.nodes,b,a),this.force.start()},startEdge:function(){this.startEdgeCreation()},selectNode:function(a){this.setSelected(a)},endEdge:function(){this.endEdgeCreation()},clear:function(){this.clearGraph(),this.redraw()}},k.create=function(a,b,c,d,e){return new j(a,b,c,d,e)},k}(gViz.getConfigration(),gViz.getBehavior(),gViz.merger,gViz.Vertex,gViz.Edge,gViz.VertexMenu,gViz.EdgeMenu,d3),String.prototype.replaceAll=function(a,b){var c=this;return c.replace(new RegExp(a,"g"),b)},angular.module("polar.util.controllers",[]),angular.module("polar.util.controllers").controller("polar.util.controllers.StaticPageController",["$scope","$routeParams",function(a,b){function c(){a.params=b}c()}]),angular.module("polar.util.controllers").controller("polar.util.controllers.modal.Controller",["$scope","$uibModalInstance","data",function(a,b,c){a.data=c,a.ok=function(a){b.close(a)},a.cancel=function(){b.dismiss("cancel")}}]),angular.module("polar.util.services",[]),angular.module("polar.util.services").factory("polar.util.services.StateHandler",["$window","$rootScope",function(a,b){function c(a,c){function f(){h.message=j.message,h.isIdle=j==i[0],h.isWorking=j==i[1],h.isSuccess=j==i[3],h.isError=j==i[4],h.isFatal=j==i[5],h.isComplete=j==i[3]||j==i[4]||j==i[5]}function g(a,c){a&&b.$broadcast("c.events.flash",{type:c,message:a})}var h={},i=[{message:""},{message:"Working"},{message:"Complete"},{message:"Success"},{message:"Error"},{message:"Fatal"}],j=i[0];return h.shouldNotRegister=a,h.heavyLoader=c||!1,h.setAllMessages=function(a){for(var b=0;b<i.length;b++)a[b]||(a[b]=""),i[b].message=a[b]},h.setMessageForState=function(a,b){i[a]&&(i[a].message=b)},h.reset=function(){return h.idle(),h},h.idle=function(){return j=i[0],f(),d(this),h},h.initiate=function(){return j=i[1],f(),e(this),h},h.success=function(a){return j=i[3],f(),d(this),g(a,"success"),h},h.error=function(a){return j=i[4],f(),d(this),g(a,"danger"),h},h.fatal=function(a){return j=i[5],a=a,f(),d(this),g(a,"danger"),h},h}function d(a){if(!a.shouldNotRegister){var b=c.queue.indexOf(a);b>-1&&c.queue.splice(b,1)}}function e(a){a.shouldNotRegister||c.queue.push(a)}return c.queue=[],c.getInstance=function(a,b){var d=new c(a,b);return d.idle(),
d},c}]),function(){function a(a){function b(a,b){this.page=1,this.ResourceClass=a,this.action=b,this.requestQueue=[],this.requestCount=0,this.totalPages=100}return b.prototype.on=function(a){return this.dataSet=a,this},b.prototype.setTotalPages=function(a){return this.totalPages=a,this},b.prototype.paginate=function(b,c,d){var e=this;if(!(e.page>e.totalPages))return e._queuePush(),1==e.requestQueue.length&&a(function(){e._dataFetch(b,c||angular.noop,d||angular.noop)},0),e},b.prototype._dataFetch=function(a,b,c){var d=this,e=_.extend(a,{from:d.page});d.ResourceClass[d.action](e).$promise.then(function(e){d._afterResolution(e,a,b,c),b(e)},function(a){c(a)})},b.prototype._afterResolution=function(a,b,c,d){var e=this;e._dataPush(a),e._setNextPage(a),e._queueShift(),e.requestQueue.length>0&&e._isValidResponse(a)?e._dataFetch(b,c,d):e.requestQueue=[]},b.prototype._setNextPage=function(a){var b=this;b._isValidResponse(a)&&(b.page=b.page+1)},b.prototype._dataPush=function(a){var b=this;angular.forEach(a,function(a){b.dataSet.push(a)})},b.prototype._queuePush=function(){var a=this;a.requestCount++,a.requestQueue.push({count:a.requestCount})},b.prototype._queueShift=function(){this.requestQueue.shift()},b.prototype._isValidResponse=function(a){return a&&a.length>0},{getInstance:function(a,c){return new b(a,c)}}}angular.module("polar.util.services").factory("polar.util.services.Paginator",["$timeout",a])}(),function(){angular.module("polar.util.services").service("polar.util.services.$Alert",["$uibModal","$q",function(a,b){var c=function(){};return c.open=function(c){var d=b.defer();return a.open({animation:!0,templateUrl:"app/scripts/util/templates/alert.html",controller:"polar.util.controllers.modal.Controller",size:c.size||"md",resolve:{data:function(){return c}}}).result.then(function(){d.resolve()},function(){d.resolve()}),d.promise},c}])}(),function(){angular.module("polar.util.services").service("polar.util.services.$Dialog",["$uibModal",function(a){var b=function(){};return b.open=function(b){return a.open({animation:!0,templateUrl:"app/scripts/util/templates/dialog.html",controller:"polar.util.controllers.modal.Controller",size:b.size||"md",resolve:{data:function(){return b}}}).result},b}])}(),function(){angular.module("polar.util.services").service("polar.util.services.$ElasticSearch",["$q",function(a){function b(a,b,c){this.index=b,this.docType=c,this.host=a,this.instance=new elasticsearch.Client({host:a})}return b.prototype.search=function(b,c,d){var e=a.defer(),f={};return self=this,d=d||{},b&&(f.query=b),c&&(f.aggs=c),f.fields=[]||d.fields,this.instance.search({index:d.index||self.index,type:d.docType||self.docType,body:f,size:d.size,from:d.from}).then(function(a){e.resolve(a)},function(a){e.reject(a)}),e.promise},b.prototype.paginate=function(b,c,d){function e(){var d=a.defer();return self.search(b,c).then(function(a){d.resolve(a.hits.total||1)},function(){d.reject(d)}),d.promise}function f(a,d){return d=d||0,d>a?void deferred.resolve(h):(self.search(b,c,{from:d,size:g}).then(function(b){h.push(b),f(a,d+g)},function(a){deferred.reject(a)}),deferred.promise)}var g=100,h=[];return deferred=a.defer(),self=this,e().then(f)},b}])}(),angular.module("polar.util.directives",["polar.util.services"]),angular.module("polar.util.directives").directive("cGlobalLoader",[function(){return{scope:{delay:"=?",heavyLoading:"="},replace:!0,templateUrl:"app/scripts/util/templates/global_loader.html",controller:["$scope","polar.util.services.StateHandler","$timeout",function(a,b,c){function d(){a.queue=b.queue}var e=(a.delay||200,{message:"Working, Please wait..."});d(),a.$watch(function(){return a.queue.length},function(b,d){function f(b,d){c(function(){a.loaderConfig=b,a.heavyLoading=_.any(a.queue,function(a){return a.heavyLoader})},d||0)}c(function(){b>0&&a.queue.length>0?f(e):f(null,a.delay)},0)})}]}}]),angular.module("polar.util",["polar.util.controllers","polar.util.services","polar.util.directives"]),angular.module("polar.data",["LocalStorageModule","polar.util"]).config(["localStorageServiceProvider",function(a){a.setPrefix("polar")}]),angular.module("polar.data").factory("polar.data.Concept",["$resource","$q",function(a,b){function c(a){var b=function(a){return a.toLocaleLowerCase().split(" ").join("-")};angular.extend(this,a),this.id=b(a.name),this.isConcept=!0,this.isVertex=!0,this.type||(this.type="concept")}return c.load=function(a){return _.map(a,function(a){return new c(a)})},c.prototype.getNames=function(){var a=[];return a.push(this.name.toLocaleLowerCase()),_.each(this.alias,function(b){a.push(b.text.toLocaleLowerCase())}),a},c}]),angular.module("polar.data").factory("polar.data.Relation",["$resource","$q",function(a,b){function c(a,b,c){this.type=a||"refers",this.out=b,this["in"]=c,this.isRelation=!0,this.isEdge=!0}return c.load=function(a){return _.map(a,function(a){return new c(a.type,a.out,a["in"])})},c}]),angular.module("polar.data").factory("polar.data.ConceptFactory",["$resource","$http","$q","polar.data.Concept","polar.data.Relation","localStorageService","polar.util.services.$ElasticSearch","polar.data.Config",function(a,b,c,d,e,f,g,h){function i(a,b){this.concepts=d.load(a)||[],this.relations=e.load(b)||[]}return i.prototype.getConceptById=function(a){return _.find(this.concepts,function(b){return b.id==a})},i.prototype.getConceptByIds=function(a){return _.filter(this.concepts,function(b){return _.include(a,b.id)})},i.prototype.getConceptNames=function(){return _.chain(this.concepts).reduce(function(a,b){return a.concat(b.getNames())},[]).sortBy(function(a){return-1*a.split(" ").length}).value()},i.prototype.getRelations=function(a){var b=_.pluck(a,"id");return _.filter(this.relations,function(a){return _.contains(b,a.out)})},i.prototype.matchConcept=function(a){return _.find(this.concepts,function(b){return aliasNameMatch=_.find(b.alias||[],function(b){return b.text.toLocaleLowerCase()==a}),b.name.toLocaleLowerCase()==a||aliasNameMatch})},i.prototype.addConcept=function(a){var b=new d(a);return this.concepts.push(b),b},i.prototype.removeConcept=function(a){this.concepts=_.filter(this.concepts,function(b){return b.id!=a})},i.prototype.updateConcept=function(a){return this.removeConcept(a.id),this.addConcept(a)},i.prototype.addRelation=function(a,b,c){this.relations.push(new e(a,b.id,c.id))},i.prototype.removeRelation=function(a){this.relations=_.filter(this.relations,function(b){return b["in"]!=a.split("_")[1]&&b.out!=a.split("_")[0]})},i.prototype.getStream=function(){return this.concepts.concat(this.relations)},i.prototype.$save=function(){var a=c.defer();return f.set("data",this),a.resolve(),a.promise},i.prototype.$upload=function(){var a=c.defer(),b=h.getData();return new g(b.endpoint).instance.create({index:b.ontologyIndex,type:b.ontologyDocType,id:parseInt(Date.now()/1e3),body:this}).then(function(){a.resolve()},function(){a.reject()}),a.promise},i.prototype.$download=function(){var a=c.defer(),d=this,e=h.getData();return b.get(e.sweetOntologyPath).then(function(b){d.concepts=b.data.concepts,d.relations=b.data.relations,a.resolve()},function(){a.reject()}),a.promise},i.prototype.metaConcepts=function(){return _.filter(this.concepts,function(a){return"meta"==a.type})},i.getInstance=function(){var a=f.get("data");return a?new i(a.concepts,a.relations):new i},i.isSet=function(){return!_.isEmpty(f.get("data"))},i}]),angular.module("polar.data").factory("polar.data.Document",["$resource","$q","polar.util.services.$ElasticSearch","polar.data.Config",function(a,b,c,d){function e(a){}return e.generateQueryObject=function(a){var b=function(a){var b=_.map(a.data,function(a){function b(a){return 90>=a&&a>=-90?a:a>90?90-a:-90-a}function c(a){return 180>=a&&a>=-180?a:a>180?180-a:-180-a}return{geo_bounding_box:{geo:{top_left:{lat:b(a[0].lat),lon:c(a[0].lng)},bottom_right:{lat:b(a[1].lat),lon:c(a[1].lng)}}}}});return{bool:{should:b}}},c=function(a){var b=_.map(a.data,function(a){return{range:{"dates.name":{gte:a.min,lte:a.max}}}});return{nested:{path:"dates",query:{bool:{should:b}}}}},d=function(a){var b=_.map(a.data,function(a){return{match:{"entities.name.raw":a}}});return{nested:{path:"entities",query:{bool:{should:b}}}}},e=function(a){var b=_.groupBy(a.entities,function(a){return a.type}),c=function(a,b){var c=_.map(b,function(b){var c={match:{}};return c.match[a+".name.raw"]=b.name,c});return{nested:{path:a,query:{bool:{should:c}}}}};return _.map(b,function(a,b){return c(b,a)})},f=function(a){var b=_.map(a.measurements,function(a){return{match:{"measurements.rawUnit-name.raw":a.name}}});return{nested:{path:"measurements",query:{bool:{should:b}}}}},g=function(a){return{terms:{"mime-type.raw":_.pluck(a.docTypes,"name")}}},h=_.map(a,function(a){return"geo"==a.type?b(a):"time"==a.type?c(a):"concept"==a.type?d(a):"measurement"==a.type?f(a):"entity"==a.type?e(a):"docType"==a.type?g(a):void 0});return _.flatten(h)},e.query=function(a,b){var f=d.getData(),g=new c(f.endpoint,f.index,f.docType);return 0==a.length?g.search(null,b):g.search({bool:{must:e.generateQueryObject(a)}},b)},e.aggregateStats=function(a){return e.query(a,{textSize:{stats:{field:"stat.extracted-text-size"}},fileSize:{stats:{field:"stat.file-size"}},infoRatio:{stats:{field:"stat.information-extracted"}},metaSize:{stats:{field:"stat.metadata-size"}},metaRatio:{stats:{field:"stat.metadata-file-size-ratio"}},datesOC:{stats:{field:"dates-occuranceCount"}},datesTC:{stats:{field:"dates-typeCount"}},entitiesOC:{stats:{field:"entities-occuranceCount"}},entitiesTC:{stats:{field:"entities-typeCount"}},locationsOC:{stats:{field:"locations-occuranceCount"}},locationsTC:{stats:{field:"locations-typeCount"}},moneyOC:{stats:{field:"money-occuranceCount"}},moneyTC:{stats:{field:"money-typeCount"}},organizationsOC:{stats:{field:"organizations-occuranceCount"}},organizationsTC:{stats:{field:"organizations-typeCount"}},peopleOC:{stats:{field:"people-occuranceCount"}},peopleTC:{stats:{field:"people-typeCount"}},percentagesOC:{stats:{field:"percentages-occuranceCount"}},percentagesTC:{stats:{field:"percentages-typeCount"}},placesOC:{stats:{field:"places-occuranceCount"}},placesTC:{stats:{field:"places-typeCount"}},timeOC:{stats:{field:"time-occuranceCount"}},timeTC:{stats:{field:"time-typeCount"}}})},e.aggregateByDates=function(a,b){return"tf-idf"==b&&(b="tf"),e.query(a,{entities:{nested:{path:"dates"},aggs:{entity_name:{terms:{field:"dates.name",size:1e3},aggs:{entity_stats:{stats:{field:"dates."+(b||"count")}}}}}}})},e.aggregateByEntity=function(a,b,c){return"tf-idf"==c&&(c="tf"),e.query(a,{entities:{nested:{path:b||"places"},aggs:{entity_name:{terms:{field:(b||"places")+".name.raw",size:1e4},aggs:{entity_stats:{stats:{field:(b||"places")+"."+(c||"count")}}}}}},entity_count:{sum:{field:"entities-occuranceCount"}}})},e.aggregateByConcepts=function(a,b){return"tf-idf"==b&&(b="tf"),e.query(a,{entities:{nested:{path:"entities"},aggs:{entity_name:{terms:{field:"entities.name.raw",size:1e3},aggs:{entity_stats:{stats:{field:"entities."+(b||"count")}}}}}},entity_count:{sum:{field:"entities-occuranceCount"}}})},e.aggregateByType=function(a){return e.query(a,{type_count:{terms:{field:"mime-type.raw",size:150}}})},e.aggregateByMeasurements=function(a){return e.query(a,{entities:{nested:{path:"measurements"},aggs:{entity_name:{terms:{field:"measurements.rawUnit-name.raw",size:1e3},aggs:{entity_stats:{stats:{field:"measurements.parsedValue"}}}}}}})},e.aggregateByRawMeasurements=function(a,b){return e.query(a,{entities:{nested:{path:"measurements"},aggs:{entity_name:{terms:{field:"measurements.rawUnit-name.raw",size:b||1e3}}}}})},e.aggregateByLocations=function(a,b,c){return"tf-idf"==b&&(b="tf"),c||(c=1e3),e.query(a,{entities:{nested:{path:"locations"},aggs:{entity_name:{terms:{field:"locations.name.raw",size:c},aggs:{lat:{max:{field:"locations.location.lat"}},lon:{max:{field:"locations.location.lon"}},entity_stats:{stats:{field:"locations."+(b||"count")}}}}}}})},e}]),angular.module("polar.data").factory("polar.data.Measurement",["$resource","$q","polar.util.services.$ElasticSearch","polar.data.Document","localStorageService","polar.data.Config",function(a,b,c,d,e,f){function g(){}return g.uploadCuratedMeasurements=function(a){var d=b.defer(),e=f.getData();return new c(e.endpoint).instance.create({index:e.measurementIndex,type:e.measurementDocType,id:parseInt(Date.now()/1e3),body:{measurements:a}}).then(function(){d.resolve()},function(){d.reject()}),d.promise},g.downloadCuratedMeasurements=function(){var a=b.defer(),d=f.getData();return new c(d.endpoint).instance.search({index:d.measurementIndex,type:d.measurementDocType,size:1}).then(function(b){a.resolve(b.hits.hits[0]._source.measurements)},function(){a.reject()}),a.promise},g.fetchDistribution=function(a,b){var e=d.generateQueryObject(b),g=f.getData();return e.push({nested:{path:"measurements",query:{bool:{should:[{match:{"measurements.rawUnit-name.raw":a}}]}},inner_hits:{}}}),new c(g.endpoint,g.index,g.docType).paginate({bool:{must:e}})},g.fetchRawMeasurements=function(){var a=e.get("measurements")||[];if(a.length>0){var c=b.defer();return c.resolve(a),c.promise}return d.aggregateByRawMeasurements([],400).then(function(a){var b=_.chain(a.aggregations.entities.entity_name.buckets).map(function(a){return{name:a.key,count:a.doc_count}}).value();return b})},g.persistRawMeasurements=function(a){e.set("measurements",a)},g}]),angular.module("polar.data").service("polar.data.Config",["$resource","$q","localStorageService",function(a,b,c){var d={data:{}};return d.save=function(a){c.set("config",a),this.data=angular.copy(a)},d.load=function(){this.data=c.get("config")||{}},d.isSet=function(){var a=this,b=function(){var b=[a.data.endpoint,a.data.index,a.data.docType,a.data.entityCountPath,a.data.measurementIndex,a.data.measurementDocType,a.data.sweetOntologyPath];return!_.any(b,_.isEmpty)};return!_.isEmpty(this.data)&&b()},d.getData=function(){return d.data},d.getExtractionURL=function(){return this.data.endpoint+"/"+this.data.index+"/"+this.data.docType},d.getOntologyURL=function(){return this.data.endpoint+"/"+this.data.ontologyIndex+"/"+this.data.ontologyDocType},d}]),angular.module("polar.data").factory("polar.data.EntityCount",["$resource","$q","$http","polar.data.Config","polar.data.ConceptFactory",function(a,b,c,d,e){var f=["entities","dates","time","places","organizations","percentages","money","people","locations"],g=function(a){_.each(_.keys(a),function(b){this[b]=angular.copy(a[b])})};return g.fetchEntites=function(){var a=["places","organizations","people","time","money","percentages"],b=function(a){return _.chain(g.data[a]).map(function(b,c){return{name:c,type:a,count:b}}).sortBy(function(a){return-a.count}).value()};return _.chain(a).reduce(function(a,c){return a[c]=b(c),a},{}).value()},g.parsedEntityList=function(){var a=e.getInstance();return _.reduce(g.data.entities,function(b,c,d){var e=a.matchConcept(d).id;return b[e]||(b[e]=0),b[e]=b[e]+c,b},{})},g.isSet=function(){return!_.isEmpty(g.data)&&_.keys(g.data).length==f.length},g.download=function(a){var e=b.defer();return c.get(d.data.entityCountPath).then(function(a){g.data=a.data,e.resolve(new g(g.data))},function(){e.reject()}),e.promise},g.fetch=function(a){var e=b.defer();if(d.data.entityCountPath)if(g.isSet()){var f=g.data;e.resolve(new g(f))}else c.get(d.data.entityCountPath).then(function(a){g.data=a.data,e.resolve(new g(g.data))},function(){e.reject()});else e.reject();return e.promise},g}]),angular.module("c.components.flash",[]),function(){var a=angular.module("c.components.flash");a.controller("c.components.flash.Controller",["$scope","$rootScope",function(a,b){function c(){b.$on("c.events.flash",function(b,c){a.flashConfig=c,a.closeFlash=!1}),b.$on("$routeChangeStart",function(b){a.flashConfig=null,a.closeFlash=!0}),a.close=d}function d(){a.closeFlash=!0}c()}])}(),function(){var a=angular.module("c.components.flash");a.directive("cFlash",[function(){return{scope:{},replace:!0,templateUrl:"app/scripts/components/flash/template.html",controller:"c.components.flash.Controller"}}])}(),angular.module("polar.components.navigation",["polar.util"]),function(){var a=angular.module("polar.components.navigation");a.controller("polar.components.navigation.Controller",["$scope","$location",function(a,b){function c(){a.$location=b}c()}])}(),function(){var a=angular.module("polar.components.navigation");a.directive("polarNavigation",[function(){return{scope:{},replace:!0,templateUrl:"app/scripts/components/navigation/template.html",controller:"polar.components.navigation.Controller",link:function(a,b,c){}}}])}(),angular.module("polar.components.footer",[]),function(){var a=angular.module("polar.components.footer");a.directive("polarFooter",[function(){return{scope:{},replace:!0,templateUrl:"app/scripts/components/footer/template.html",controller:"polar.util.controllers.StaticPageController",link:function(a,b,c){}}}])}(),angular.module("polar.components.configuration",["polar.util","polar.data"]),function(){var a=angular.module("polar.components.configuration");a.controller("polar.components.configuration.Controller",["$scope","polar.data.Config","polar.util.services.$Alert","polar.util.services.StateHandler","polar.data.ConceptFactory","polar.data.EntityCount","$timeout",function(a,b,c,d,e,f,g){function h(){a.config=b.getData(),a.cFactory=e.getInstance(),a.saveConfig=j,a.isConfigSet=k,a.isOntologySet=l,a.downloadOntology=n,a.downloadEntityCount=m,a.loadDefault=i,a.entityCountSet=f.isSet(),g(function(){a.entityCountSet=f.isSet()},500)}function i(){a.config={endpoint:"http://polar.usc.edu/elasticsearch",index:"polar-deep-insights-complete",docType:"docs",ontologyIndex:"polar-ontology",ontologyDocType:"graph",measurementIndex:"polar-measurements",measurementDocType:"raw-measurements",entityCountPath:"http://polar.usc.edu/html/polar-deep-insights/data/entity-count.json",sweetOntologyPath:"http://polar.usc.edu/html/polar-deep-insights/data/sea-ice.json"}}function j(a){c.open({message:"Successfully saved configuration to local storage"}),b.save(a)}function k(){return b.isSet()}function l(){return e.isSet()}function m(){var b=d.getInstance();b.initiate(),f.download().then(function(d){c.open({message:"Successfully downloaded counts and saved into local storage"}),b.success(),a.entityCountSet=!0},function(){b.fatal("Error while downloading counts, check URL")})}function n(){var b=d.getInstance();b.initiate(),a.cFactory.$download().then(function(){a.cFactory.$save()}).then(function(a){c.open({message:"Successfully downloaded ontology and saved into local storage"}),b.success()},function(){b.fatal("Error while loading ontology")})}h()}])}(),function(){var a=angular.module("polar.components.configuration");a.directive("polarConfiguration",[function(){return{scope:{},replace:!0,templateUrl:"app/scripts/components/configuration/template.html",controller:"polar.components.configuration.Controller",link:function(a,b,c){}}}])}(),angular.module("polar.components.measurementEditor",["polar.util","polar.data","polar.components.analytics.measurement"]),function(){var a=angular.module("polar.components.measurementEditor");a.controller("polar.components.measurementEditor.Controller",["$scope","polar.util.services.StateHandler","polar.data.Measurement","polar.components.analytics.measurement.$HistModal","polar.util.services.$Alert",function(a,b,c,d,e){function f(){a.save=i,a.upload=j,a.download=k,a.showDistribution=l,a.groups=[],h()}function g(b){a.allMeasurements=_.groupBy(b,function(a){return a.group}),delete a.allMeasurements.undefined,a.measurements=_.filter(b,function(a){return!a.group}),a.groups=_.chain(b).map(function(a){return a.group}).filter(function(a){return!_.isEmpty(a)}).unique().value()}function h(){var a=b.getInstance();a.initiate(),c.fetchRawMeasurements().then(function(b){g(b),a.success()},function(){a.fatal()})}function i(){var b=_.flatten([_.values(a.allMeasurements),a.measurements]);c.persistRawMeasurements(b),e.open({message:"Curated measurements persisted"})}function j(){var d=b.getInstance();d.initiate();var f=_.flatten([_.values(a.allMeasurements),a.measurements]);c.uploadCuratedMeasurements(f).then(function(){e.open({message:"Curated measurements successfully uploaded"}),d.success()},function(){d.fatal()})}function k(){var a=b.getInstance();a.initiate(),c.downloadCuratedMeasurements().then(function(b){g(b),e.open({message:"Curated measurements successfully download"}),a.success()},function(){a.fatal()})}function l(a){d.open({unit:a,filters:[]})}a.addGroup=function(){a.groups.push(a.groupName),a.groupName=null},a.removeGroup=function(b){a.groups.splice(b,1)},a.selectGroup=function(b){a.selectedGroup!=b?a.selectedGroup=b:a.selectedGroup=null},f(),a.$watch("selectedGroup",function(){a.groups[a.selectedGroup]&&(a.allMeasurements[a.groups[a.selectedGroup]]||(a.allMeasurements[a.groups[a.selectedGroup]]=[]))})}])}(),function(){var a=angular.module("polar.components.measurementEditor");a.directive("polarMeasurementEditor",[function(){return{scope:{},replace:!0,templateUrl:"app/scripts/components/measurement_editor/template.html",controller:"polar.components.measurementEditor.Controller",link:function(a,b,c){a.sortableOptions={placeholder:"measurements",connectWith:".measurements-container",update:function(b,c){!c.item.sortable.received&&c.item.sortable.source[0]!==c.item.sortable.droptarget[0]&&c.item.sortable.source.hasClass("source")&&c.item.sortable.droptarget.hasClass("target")&&(c.item.sortable.model.group=a.groups[a.selectedGroup]),!c.item.sortable.received&&c.item.sortable.source[0]!==c.item.sortable.droptarget[0]&&c.item.sortable.source.hasClass("target")&&c.item.sortable.droptarget.hasClass("source")&&(c.item.sortable.model.group=null)}}}}}])}(),angular.module("polar.components.conceptEditor.concept",["ngTagsInput","polar.util"]),function(){var a=angular.module("polar.components.conceptEditor.concept");a.controller("polar.components.conceptEditor.concept.Controller",["$scope",function(a){function b(){a.concept||(a.concept={},a.concept.alias=[]),a.concept.isValid=function(){return this.name&&this.type}}b()}])}(),function(){var a=angular.module("polar.components.conceptEditor.concept");a.directive("polarConceptBox",[function(){return{scope:{concept:"=",validator:"&"},replace:!0,templateUrl:"app/scripts/components/concept_editor/concept/template.html",controller:"polar.components.conceptEditor.concept.Controller",link:function(a,b,c){}}}])}(),function(){angular.module("polar.components.conceptEditor.concept").service("polar.components.conceptEditor.concept.$Modal",["$uibModal",function(a){var b=function(){};return b.open=function(b){return a.open({animation:!0,templateUrl:"app/scripts/components/concept_editor/concept/modal_template.html",controller:"polar.util.controllers.modal.Controller",size:"sm",resolve:{data:function(){return{concept:b}}}}).result},b}])}(),angular.module("polar.components.conceptEditor.export",["polar.util"]),function(){var a=angular.module("polar.components.conceptEditor.export");a.controller("polar.components.conceptEditor.export.Controller",["$scope",function(a){function b(){a.entityString=a.factory.getConceptNames().join("\n")}b()}])}(),function(){var a=angular.module("polar.components.conceptEditor.export");a.directive("polarConceptExport",[function(){return{scope:{factory:"="},replace:!0,templateUrl:"app/scripts/components/concept_editor/export/template.html",controller:"polar.components.conceptEditor.export.Controller",link:function(a,b,c){}}}])}(),function(){angular.module("polar.components.conceptEditor.export").service("polar.components.conceptEditor.export.$Modal",["$uibModal",function(a){var b=function(){};return b.open=function(b){return a.open({animation:!0,templateUrl:"app/scripts/components/concept_editor/export/modal_template.html",controller:"polar.util.controllers.modal.Controller",size:"lg",resolve:{data:function(){return{factory:b}}}}).result},b}])}(),angular.module("polar.components.conceptEditor",["tg.graph","polar.components.conceptEditor.concept","polar.components.conceptEditor.export","polar.data","polar.util"]),function(){var a=angular.module("polar.components.conceptEditor");a.controller("polar.components.conceptEditor.Controller",["$scope","$timeout","tg.graph.aside.$aside","polar.components.conceptEditor.concept.$Modal","polar.data.ConceptFactory","polar.util.services.$Alert","polar.util.services.$Dialog","polar.components.conceptEditor.export.$Modal","polar.util.services.StateHandler",function(a,b,c,d,e,f,g,h,i){function j(){a.stream=a.factory.getStream(),a.graph.clear(),a.graph.data(a.stream).redraw()}a.onGraphLoad=function(b){a.graph=b,a.graph.on("node/click",function(a){c.refresh(a)}),a.graph.on("edge/create",function(b,c){a.addRelation("refers",b,c)}),a.graph.on("edge/click",function(a){c.refresh(a)}),a.graph.on("node/dblclick",function(a){console.log("node/dblclick")}),a.graph.on("node/load",function(a,b){console.log("node/load")}),a.state=i.getInstance(),j()},a.edgeMenu=[{name:"",placeholder:"Inspect",onClick:function(a){c.open(a)}},{name:"",placeholder:"Remove edge",onClick:function(b){a.removeRelation(b,b.id)}}],a.nodeMenu=[{name:"",onClick:function(b){a.editConcept(b,b.source)}},{name:"",placeholder:"Delete vertex",onClick:function(b,c){a.removeConcept(b,b.id)}},{name:"",placeholder:"Connect",onClick:function(b){a.graph.startEdge()}},{name:"",placeholder:"Inspect",onClick:function(a){c.open(a)}}],a.metadata={},a.behavior={},a.configration={height:780,width:$(".body-container").width()},a.factory=e.getInstance(),a.addConcept=function(){d.open({}).then(function(b){a.graph.data([a.factory.addConcept(b)]).redraw()})},a.editConcept=function(b,c){d.open(c).then(function(b){a.graph.data([a.factory.updateConcept(b)]).redraw()})},a.removeConcept=function(b,c){a.graph.removeVertex(b),a.factory.removeConcept(c)},a.addRelation=function(b,c,d){a.factory.addRelation(b,c,d),a.graph.data([{out:c.identifier(),"in":d.identifier(),type:"refers"}]).redraw(),a.$apply(function(){a.graph.endEdgeCreation()})},a.removeRelation=function(b,c){a.factory.removeRelation(c),a.graph.removeEdge(b)},a.saveLocally=function(){a.factory.$save(),f.open({message:"Concept graph successfully saved in local storage"})},a["export"]=function(){h.open(a.factory)},a.upload=function(){a.state.initiate(),a.factory.$upload().then(function(){a.state.success("Successfully uploaded ontology")},function(){a.state.fatal("Error while saving ontology")})},a.download=function(){a.state.initiate(),a.factory.$download().then(function(b){j(),a.state.success()},function(){a.state.fatal("Error while loading ontology")})}}])}(),function(){var a=angular.module("polar.components.conceptEditor");a.directive("polarConceptEditor",[function(){return{scope:{},replace:!0,templateUrl:"app/scripts/components/concept_editor/template.html",controller:"polar.components.conceptEditor.Controller",link:function(a,b,c){}}}])}(),angular.module("polar.components.addFilter",["polar.util"]),function(){var a=angular.module("polar.components.addFilter");a.controller("polar.components.addFilter.Controller",["$scope","polar.components.addFilter.$TypeModal",function(a,b){function c(){a.addFilter=d}function d(){b.open().then(function(b){a.filters.push(b)})}c()}])}(),function(){var a=angular.module("polar.components.addFilter");a.directive("polarAddFilter",[function(){return{scope:{filters:"="},replace:!0,templateUrl:"app/scripts/components/add_filter/template.html",controller:"polar.components.addFilter.Controller",link:function(a,b,c){}}}])}(),function(){angular.module("polar.components.addFilter").service("polar.components.addFilter.$TypeModal",["$uibModal",function(a){var b=function(){};return b.open=function(){return a.open({animation:!0,templateUrl:"app/scripts/components/add_filter/modal_template.html",controller:"polar.util.controllers.modal.Controller",size:"sm",resolve:{data:{}}}).result},b}])}(),angular.module("polar.components.filter.docType",["ngTagsInput","polar.util","polar.data"]),function(){var a=angular.module("polar.components.filter.docType");a.controller("polar.components.filter.docType.Controller",["$scope","polar.data.Document","$filter","polar.util.services.StateHandler","$q",function(a,b,c,d,e){function f(){a.filterTypes=h,a.addType=g,a.filter.docTypes||(a.filter.docTypes=[]),i()}function g(b){a.filter.docTypes=a.filter.docTypes.concat(b)}function h(b){var d=e.defer();return a.types.length>0?d.resolve(c("filter")(a.types,b)):d.reject(),d.promise}function i(){var c=d.getInstance();c.initiate(),b.aggregateByType([]).then(function(b){a.types=_.chain(b.aggregations.type_count.buckets).pluck("key").map(function(a){return{name:a}}).value(),c.success()},function(){c.fatal()})}f()}])}(),function(){var a=angular.module("polar.components.filter.docType");a.directive("polarFilterDocType",[function(){return{scope:{filter:"="},replace:!0,templateUrl:"app/scripts/components/filter/doc_type/template.html",controller:"polar.components.filter.docType.Controller",link:function(a,b,c){}}}])}(),angular.module("polar.components.filter.entity",["ngTagsInput","polar.util","polar.data"]),function(){var a=angular.module("polar.components.filter.entity");a.controller("polar.components.filter.entity.Controller",["$scope","polar.data.EntityCount","$filter","polar.util.services.StateHandler","$q",function(a,b,c,d,e){function f(){a.filterEntities=h,a.addEntity=g,a.filter.entities||(a.filter.entities=[]),i()}function g(b){a.filter.entities=a.filter.entities.concat(b)}function h(b){var d=e.defer();return d.resolve(c("filter")(a.entities[a.type],b)),d.promise}function i(){var c=d.getInstance();c.initiate(),a.entities=b.fetchEntites(),c.success()}f()}])}(),function(){var a=angular.module("polar.components.filter.entity");a.directive("polarFilterEntity",[function(){return{scope:{filter:"="},replace:!0,templateUrl:"app/scripts/components/filter/entity/template.html",controller:"polar.components.filter.entity.Controller",link:function(a,b,c){}}}])}(),angular.module("polar.components.filter.measurement",["ngTagsInput","polar.util","polar.data","polar.components.analytics.measurement"]),function(){var a=angular.module("polar.components.filter.measurement");a.controller("polar.components.filter.measurement.Controller",["$scope","polar.data.Measurement","$filter","polar.util.services.StateHandler","$q","polar.components.analytics.measurement.$HistModal",function(a,b,c,d,e,f){function g(){a.openHist=k,a.filterMeasurements=i,a.addFilter=h,a.measurements=[],a.filter.measurements||(a.filter.measurements=[]),j()}function h(b){a.filter.measurements=a.filter.measurements.concat(b)}function i(b){var d=e.defer();return d.resolve(c("filter")(a.measurements,b)),d.promise}function j(){var c=d.getInstance();return c.initiate(),b.fetchRawMeasurements().then(function(b){b=_.filter(b,function(a){return a.group}),a.measurements=b,c.success()},function(){c.fatal("Unable to fetch valid measurements")})}function k(b){f.open({unit:b,filters:a.filters})}g()}])}(),function(){var a=angular.module("polar.components.filter.measurement");a.directive("polarFilterMeasurement",[function(){return{scope:{filter:"="},replace:!0,templateUrl:"app/scripts/components/filter/measurement/template.html",controller:"polar.components.filter.measurement.Controller",link:function(a,b,c){}}}])}(),angular.module("polar.components.filter.geo",["polar.util","ui-leaflet"]),function(){var a=angular.module("polar.components.filter.geo");a.controller("polar.components.filter.geo.Controller",["$scope","leafletDrawEvents",function(a,b){function c(){a.filter.regions||(a.filter.regions=[]),a.data=[],a.map={center:{lat:0,lng:0,zoom:2},drawOptions:{position:"bottomright",draw:{polyline:!1,polygon:!1,circle:!1,marker:!1},edit:{featureGroup:d,remove:!1,edit:!1}}},a.removeRegion=g}var d=new L.FeatureGroup,e=b.getAvailableEvents();e.forEach(function(b){a.$on("leafletDirectiveDraw."+b,function(a,c){var d,e,f,g;d=c.leafletEvent,e=c.leafletObject,f=c.model,g=c.modelName,h[b.replace("draw:","")](a,d,e,f,g)})});var f=function(b,c){var d=a.filter.regions.length+1,e="Region-"+d,f={
name:e,coords:b,layer:c};a.filter.regions.push(f)},g=function(b){d.removeLayer(a.filter.regions[b].layer),a.filter.regions.splice(b,1)},h={created:function(a,b,c,e,g){d.addLayer(b.layer),f(b.layer._latlngs,b.layer)},edited:function(a){},deleted:function(a){},drawstart:function(a){},drawstop:function(a){},editstart:function(a){},editstop:function(a){},deletestart:function(a){},deletestop:function(a){}};c()}])}(),function(){var a=angular.module("polar.components.filter.geo");a.directive("polarFilterGeo",[function(){return{scope:{filter:"="},replace:!0,templateUrl:"app/scripts/components/filter/geo/template.html",controller:"polar.components.filter.geo.Controller",link:function(a,b,c){}}}])}(),angular.module("polar.components.filter.time",["polar.util","rzModule"]),function(){var a=angular.module("polar.components.filter.time");a.controller("polar.components.filter.time.Controller",["$scope",function(a){function b(){a.filter.timeRanges||(a.filter.timeRanges=[],d()),a.addRange=d}function c(){var a={};return a.min=1980,a.max=1985,a}function d(){a.filter.timeRanges.push(c())}b()}])}(),function(){var a=angular.module("polar.components.filter.time");a.directive("polarFilterTime",[function(){return{scope:{filter:"="},replace:!0,templateUrl:"app/scripts/components/filter/time/template.html",controller:"polar.components.filter.time.Controller",link:function(a,b,c){}}}])}(),angular.module("polar.components.filter.concept",["ngTagsInput","polar.util"]),function(){var a=angular.module("polar.components.filter.concept");a.controller("polar.components.filter.concept.SearchController",["$scope","polar.data.ConceptFactory","$q","$filter",function(a,b,c,d){function e(){a.factory=b.getInstance(),a.conceptNames=a.factory.getConceptNames()}a.filterConcepts=function(b){var e=c.defer();return e.resolve(d("filter")(a.conceptNames,b)),e.promise},e()}])}(),function(){var a=angular.module("polar.components.filter.concept");a.directive("polarFilterConceptSearch",[function(){return{scope:{filter:"=",helpers:"="},replace:!0,templateUrl:"app/scripts/components/filter/concept/search_template.html",controller:"polar.components.filter.concept.SearchController",link:function(a,b,c){}}}])}(),function(){var a=angular.module("polar.components.filter.concept");a.controller("polar.components.filter.concept.Controller",["$scope","polar.data.ConceptFactory","tg.graph.aside.$aside",function(a,b,c){function d(){a.store=b.getInstance(),a.filter.factory||(a.filter.factory=new b(a.filter.concepts,a.filter.relations)),a.factory=a.filter.factory}function e(){a.stream=a.factory.getStream(),a.graph.clear(),a.graph.data(a.stream).redraw()}a.onGraphLoad=function(b){a.graph=b,a.graph.on("node/click",function(a){c.refresh(a)}),a.graph.on("edge/click",function(a){c.refresh(a)}),a.graph.on("node/dblclick",function(b){if(!b.loaded){var c=a.store.getConceptById(b.id);a.factory.concepts.push(c),e()}}),a.graph.on("node/load",function(a,b){console.log("node/load")}),d(),e()},a.edgeMenu=[{name:"",placeholder:"Inspect",onClick:function(a){c.open(a)}},{name:"",placeholder:"Remove edge",onClick:function(b){a.removeRelation(b,b.id)}}],a.nodeMenu=[{name:"",placeholder:"Delete vertex",onClick:function(b,c){a.removeConcept(b,b.id)}},{name:"",placeholder:"Load Parent",onClick:function(b){a.loadParentEdges(b.id)}},{name:"",placeholder:"Inspect",onClick:function(a){c.open(a)}},{name:"",placeholder:"Load Children",onClick:function(b){a.loadChildrenEdges(b.id)}}],a.removeConcept=function(b,c){a.graph.removeVertex(b),a.factory.removeConcept(c)},a.removeRelation=function(b,c){a.factory.removeRelation(c),a.graph.removeEdge(b)},a.helpers={},a.helpers.onConceptAdd=function(b){var c=_.map(b,function(b){return a.store.matchConcept(b.text)});a.factory.concepts=a.factory.concepts.concat(c),a.graph.data(c).redraw()},a.loadParentEdges=function(b){var c=_.filter(a.store.relations,function(a){return a.out==b}),d=a.factory.relations;a.factory.relations=_.uniq(d.concat(c)),a.graph.data(_.difference(c,d)).redraw()},a.loadChildrenEdges=function(b){var c=_.filter(a.store.relations,function(a){return a["in"]==b}),d=a.factory.relations;a.factory.relations=_.uniq(d.concat(c)),a.graph.data(_.difference(c,d)).redraw()}}])}(),function(){var a=angular.module("polar.components.filter.concept");a.directive("polarFilterConcept",[function(){return{scope:{filter:"="},replace:!0,templateUrl:"app/scripts/components/filter/concept/template.html",controller:"polar.components.filter.concept.Controller",link:function(a,b,c){}}}])}(),angular.module("polar.components.filter",["polar.util","polar.components.filter.geo","polar.components.filter.time","polar.components.filter.concept","polar.components.filter.measurement","polar.components.filter.entity","polar.components.filter.docType"]),function(){angular.module("polar.components.filter").service("polar.components.filter.$FilterParser",["$q",function(a){return function(a){var b=_.chain(a).filter(function(a){return a.$valid}).map(function(a){return"geo"==a.type&&(a.data=_.map(a.regions,function(a){return[a.coords[1],a.coords[3]]})),"concept"==a.type&&(a.data=_.reduce(a.factory.concepts,function(a,b){return a.concat(b.getNames())},[])),"time"==a.type&&(a.data=a.timeRanges),a}).value();return b}}])}(),function(){angular.module("polar.components.filter").service("polar.components.filter.$EditModal",["$uibModal",function(a){var b=function(){};return b.open=function(b){var c="geo"==b.type||"concept"==b.type?"lg":"md";return a.open({animation:!0,templateUrl:"app/scripts/components/filter/edit_modal_template.html",controller:"polar.util.controllers.modal.Controller",size:c,resolve:{data:function(){return{filter:b}}}}).result},b}])}(),function(){var a=angular.module("polar.components.filter");a.controller("polar.components.filter.Controller",["$scope","polar.components.filter.$EditModal",function(a,b){function c(){a.edit=d}function d(a){b.open(angular.copy(a)).then(function(b){a.measurements=b.measurements||[],a.entities=b.entities||[],a.regions=b.regions||[],a.timeRanges=b.timeRanges||[],a.factory=b.factory||{},a.docTypes=b.docTypes||{},a.$valid=a.entities&&a.entities.length>0||a.measurements&&a.measurements.length>0||a.regions&&a.regions.length>0||a.timeRanges&&a.timeRanges.length>0||a.factory.concepts&&a.factory.concepts.length>0||a.docTypes&&a.docTypes.length>0})}c()}])}(),function(){var a=angular.module("polar.components.filter");a.directive("polarFilter",[function(){return{scope:{filter:"=",onDelete:"&"},replace:!0,templateUrl:"app/scripts/components/filter/template.html",controller:"polar.components.filter.Controller",link:function(a,b,c){}}}])}(),angular.module("polar.components.analytics.filter",[]),function(){var a=angular.module("polar.components.analytics.filter");a.directive("polarAnalyticsFilter",[function(){return{scope:{field:"=",fn:"="},replace:!0,templateUrl:"app/scripts/components/analytics/filter/template.html",link:function(a,b,c){a.$watch("field",function(b){"tf-idf"==b&&(a.fn="sum")})}}}])}(),angular.module("polar.components.analytics.stats",["polar.util","polar.data","nvd3"]),function(){var a=angular.module("polar.components.analytics.stats");a.controller("polar.components.analytics.stats.Controller",["$scope","polar.data.Document","polar.components.filter.$FilterParser","polar.util.services.StateHandler",function(a,b,c,d){function e(){a.keys=["entities","dates","time","places","organizations","percentages","money","people","locations"],a.loadData=f,f()}function f(){var e=d.getInstance(!1,!0);e.initiate(),b.aggregateStats([]).then(function(d){return a.totalDocCount=d.hits.total,b.aggregateStats(c(a.filters))}).then(function(b){a.docCount=b.hits.total,a.results=b.aggregations,a.data=[{key:"Filtered",y:a.docCount},{key:"Rest",y:a.totalDocCount-a.docCount}],e.success()},function(){e.fatal()}),g()}function g(){var e=d.getInstance(!1,!0);e.initiate(),b.aggregateByType(c(a.filters)).then(function(b){a.typeData=b.aggregations.type_count.buckets,e.success()},function(){e.fatal()})}e(),a.$on("polar.components.analytics.reloadData.Stats",function(a){f()})}])}(),function(){var a=angular.module("polar.components.analytics.stats");a.directive("polarAnalyticsStats",[function(){return{scope:{filters:"="},replace:!0,templateUrl:"app/scripts/components/analytics/stats/template.html",controller:"polar.components.analytics.stats.Controller",link:function(a,b,c){a.options={chart:{type:"pieChart",height:450,donut:!0,x:function(a){return a.key},y:function(a){return a.y},showLabels:!0,pie:{startAngle:function(a){return a.startAngle/2-Math.PI/2},endAngle:function(a){return a.endAngle/2-Math.PI/2}},duration:500,legend:{margin:{top:5,right:70,bottom:5,left:0}}}},a.typeOptions={chart:{type:"pieChart",height:1e3,x:function(a){return a.key.split(";")[0].substring(0,25)},y:function(a){return a.doc_count},showLabels:!0,duration:500,labelThreshold:.01,labelSunbeamLayout:!0,legend:{margin:{top:5,right:35,bottom:5,left:0}}}}}}}])}(),angular.module("polar.components.analytics.timeVariance",["polar.util","polar.data","polar.components.filter","nvd3","rzModule","polar.components.analytics.filter"]),function(){var a=angular.module("polar.components.analytics.timeVariance");a.controller("polar.components.analytics.timeVariance.Controller",["$scope","polar.data.Document","polar.components.filter.$FilterParser","polar.util.services.StateHandler",function(a,b,c,d){function e(){a.state=d.getInstance(!1,!0),a.r={min:1950,max:2020},f()}function f(){function d(b,c){if("tf-idf"==a.field){var d=Math.log(1+b/c.doc_count),e=1+Math.log(c.entity_stats[a.fn]);return e*d}return c.entity_stats[a.fn]}a.state.initiate(),b.aggregateByDates(c(a.filters),a.field).then(function(b){var c=b.hits.total,e=_.chain(b.aggregations.entities.entity_name.buckets).filter(function(b){return b.key>=a.r.min&&b.key<=a.r.max}).sortBy(function(a){return a.key}).value();a.data=[{key:"Computed",values:_.map(e,function(a){return{series:"Computed",x:a.key,y:d(c,a)}})}],a.state.success()},function(){a.state.fatal("Unable to load data")})}a.$on("polar.components.analytics.reloadData.Time",function(a,b){f()}),e()}])}(),function(){var a=angular.module("polar.components.analytics.timeVariance");a.directive("polarAnalyticsTimeVariance",["$timeout",function(a){return{scope:{filters:"="},replace:!0,templateUrl:"app/scripts/components/analytics/time_variance/template.html",controller:"polar.components.analytics.timeVariance.Controller",link:function(b,c,d){a(function(){b.$broadcast("reCalcViewDimensions")},100),b.options={chart:{type:"multiBarChart",height:600,margin:{top:20,right:20,bottom:45,left:80},clipEdge:!0,duration:500,stacked:!0,xAxis:{axisLabel:"Years",showMaxMin:!1},yAxis:{axisLabel:"Frequency"}}}}}}])}(),angular.module("polar.components.analytics.geoDistribution",["polar.util","polar.data","rzModule","polar.components.analytics.filter"]),function(){var a=angular.module("polar.components.analytics.geoDistribution");a.controller("polar.components.analytics.geoDistribution.Controller",["$scope","polar.data.Document","polar.components.filter.$FilterParser","polar.util.services.StateHandler",function(a,b,c,d){function e(){a.state=d.getInstance(!1,!0),f()}function f(){function d(b,c){if("tf-idf"==a.field){var d=Math.log(1+b/c.doc_count),e=1+Math.log(c.entity_stats[a.fn]);return e*d}return c.entity_stats[a.fn]}a.state.initiate(),b.aggregateByLocations(c(a.filters),a.field).then(function(b){var c=b.hits.total,e=_.chain(b.aggregations.entities.entity_name.buckets).map(function(a){return{name:a.key,count:d(c,a),country:"USA",fillKey:"USA",latitude:a.lat.value,longitude:a.lon.value}}).sortBy(function(a){return-a.count}).value();a.state.success(),e=e.slice(0,a.slider.value);var f=_.max(e,function(a){return a.count}).count,g=_.map(e,function(b){return b.radius=b.count/f*(a.slider.scale||100),b});a.loadMap(g)},function(){a.state.fatal()})}a.$on("polar.components.analytics.reloadData.Geo",function(a){f()}),e()}])}(),function(){var a=angular.module("polar.components.analytics.geoDistribution");a.directive("polarAnalyticsGeoDistribution",["$timeout",function(a){return{scope:{filters:"="},replace:!0,templateUrl:"app/scripts/components/analytics/geo_distribution/template.html",controller:"polar.components.analytics.geoDistribution.Controller",link:function(b,c,d){var e=c.find(".idf-location")[0],f=new Datamap({element:e,height:800,width:$(".query-result").width(),geographyConfig:{popupOnHover:!1,highlightOnHover:!1,hideAntarctica:!1},fills:{defaultFill:"#ABDDA4",USA:"red"}}),g=function(a){f.bubbles(a,{popupTemplate:function(a,b){return'<div class="hoverinfo">Name:'+b.name+"</div>"}})};b.loadMap=g,a(function(){b.$broadcast("reCalcViewDimensions")},100)}}}])}(),angular.module("polar.components.analytics.geoDiversity",["polar.util","polar.data","ui-leaflet"]),function(){var a=angular.module("polar.components.analytics.geoDiversity");a.controller("polar.components.analytics.geoDiversity.Controller",["$scope","polar.data.Document","polar.components.filter.$FilterParser","polar.util.services.StateHandler",function(a,b,c,d){function e(){a.state=d.getInstance(!1,!0),a.options={maxZoom:14,minZoom:2,maxBounds:{northEast:{lat:95,lng:180},southWest:{lat:-95,lng:-180}}},a.center={lat:0,lng:0,zoom:2},a.events={map:{enable:["moveend","popupopen"],logic:"emit"},marker:{enable:[],logic:"emit"}},a.layers={baselayers:{osm:{name:"OpenStreetMap",type:"xyz",url:"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}},overlays:{realworld:{name:"Trec Polar Data",type:"markercluster",visible:!0}}},a.map={},a.map.markers={},f()}function f(){a.state.initiate(),b.aggregateByLocations(c(a.filters),"count",1e4).then(function(b){a.map.markers=_.chain(b.aggregations.entities.entity_name.buckets).reduce(function(a,b,c){return a["marker"+c]={message:b.key,lat:b.lat.value,lng:b.lon.value,size:b.doc_count,draggable:!1,layer:"realworld"},a},{}).value(),a.state.success()},function(){a.state.fatal()})}a.$on("polar.components.analytics.reloadData.GeoDiversity",function(a){f()}),e()}])}(),function(){var a=angular.module("polar.components.analytics.geoDistribution");a.directive("polarAnalyticsGeoDiversity",[function(){return{scope:{filters:"="},replace:!0,templateUrl:"app/scripts/components/analytics/geo_diversity/template.html",controller:"polar.components.analytics.geoDiversity.Controller",link:function(a,b,c){}}}])}(),angular.module("polar.components.analytics.concept",["polar.util","polar.data","nvd3","polar.components.analytics.filter"]),function(){var a=angular.module("polar.components.analytics.concept");a.controller("polar.components.analytics.concept.Controller",["$scope","polar.data.Document","polar.components.filter.$FilterParser","polar.util.services.StateHandler","polar.data.ConceptFactory","$q",function(a,b,c,d,e,f){function g(){a.state=d.getInstance(!1,!0),a.store=e.getInstance(),a.factory=new e,a.nResults=10,a.inferenceBound=2,i()}function h(){a.stream=a.factory.getStream(),a.graph.clear(),a.graph.data(a.stream).redraw()}function i(){a.state.initiate();var d=c(a.filters);b.aggregateByConcepts(d,a.field).then(function(b){var c=b.hits.total,e=_.chain(d).filter(function(a){return"concept"==a.type}).pluck("data").flatten().map(function(b){return a.store.matchConcept(b)}).value(),f=_.chain(e).pluck("id").uniq().value(),g=_.chain(b.aggregations.entities.entity_name.buckets).map(function(b){var d=a.store.matchConcept(b.key);if(d)if("tf-idf"==a.field){var e=Math.log(1+b.doc_count/c),f=1+Math.log(b.entity_stats[a.fn]);d.value=f*e}else d.value=b.entity_stats[a.fn];return d}).filter(function(a){return a}).map(function(a){return{id:a.id,label:a.id,value:a.value}}).sortBy(function(a){return-a.value}).value(),i=_.filter(g,function(a){return _.contains(f,a.label)}),k=_.filter(g,function(a){return!_.contains(f,a.label)}).slice(0,a.nResults);a.data=[{key:"Filtered",color:"#d62728",values:i},{key:"Extracted",color:"#1f77b4",values:k}],a.factory.concepts=a.store.getConceptByIds(_.pluck(k,"id"));var i=_.map(a.store.getConceptByIds(_.pluck(i,"id")),function(a){return a.type="Filtered",a});a.factory.concepts=a.factory.concepts.concat(i),a.factory.relations=a.store.getRelations(a.factory.concepts),j.promise.then(function(){h()}),a.state.success(),a.infered=_.chain(a.factory.relations).groupBy(function(a){return a["in"]}).reduce(function(b,c,d){return c.length>=a.inferenceBound&&(b[d]=c.length),b},{}).keys().value(),a.api.api&&(a.api.api.clearElement(),a.options.chart.height=25*a.nResults,a.api.api.refresh())},function(){a.state.fatal()})}var j=f.defer();a.onGraphLoad=function(b){a.graph=b,j.resolve()},a.edgeMenu=[],a.nodeMenu=[],a.metadata={},a.behavior={},a.configration={height:780,width:$(".body-container").width()},a.$on("polar.components.analytics.reloadData.Concept",function(a){i()}),g()}])}(),function(){var a=angular.module("polar.components.analytics.concept");a.directive("polarAnalyticsConcept",[function(){return{scope:{filters:"="},replace:!0,templateUrl:"app/scripts/components/analytics/concept/template.html",controller:"polar.components.analytics.concept.Controller",link:function(a,b,c){a.options={chart:{type:"multiBarHorizontalChart",height:500,width:1150,margin:{left:150},x:function(a){return a.label},y:function(a){return a.value},showControls:!0,showValues:!0,duration:500,xAxis:{showMaxMin:!1},yAxis:{axisLabel:"Value",tickFormat:function(a){return d3.format(",.2f")(a)}}}},a.api={}}}}])}(),angular.module("polar.components.analytics.popularEntities",["polar.util","polar.data","nvd3","polar.components.analytics.filter"]),function(){var a=angular.module("polar.components.analytics.popularEntities");a.controller("polar.components.analytics.popularEntities.Controller",["$scope","polar.data.Document","polar.components.filter.$FilterParser","polar.util.services.StateHandler",function(a,b,c,d){function e(){a.state=d.getInstance(!1,!0),f()}function f(){a.state.initiate(),b.aggregateByEntity(c(a.filters),a.eType,a.field).then(function(b){var c=b.hits.total,d=_.chain(b.aggregations.entities.entity_name.buckets).map(function(b){var d={};if(d.label=b.key,"tf-idf"==a.field){var e=Math.log(1+c/b.doc_count),f=1+Math.log(b.entity_stats[a.fn]);d.value=f*e}else d.value=b.entity_stats[a.fn];return d}).sortBy(function(a){return-a.value}).value().slice(0,500),e=_.chain(a.filters).pluck("entities").flatten().filter(function(b){return b.type==a.eType}).pluck("name").value(),f=_.filter(d,function(a){return _.contains(e,a.label)}),g=_.filter(d,function(a){return!_.contains(e,a.label)});a.data=[],f.length>0&&a.data.push({key:"Filtered",color:"#d62728",values:f}),a.data.push({key:"Extracted",color:"#1f77b4",values:g}),a.state.success()},function(){a.state.fatal()})}e(),a.$on("polar.components.analytics.reloadData.PopularEntities",function(a){f()})}])}(),function(){var a=angular.module("polar.components.analytics.popularEntities");a.directive("polarAnalyticsPopularEntities",[function(){return{scope:{filters:"="},replace:!0,templateUrl:"app/scripts/components/analytics/popular_entities/template.html",controller:"polar.components.analytics.popularEntities.Controller",link:function(a,b,c){a.options={chart:{type:"multiBarHorizontalChart",height:6e3,width:1150,margin:{left:150},x:function(a){return a.label},y:function(a){return a.value},showControls:!0,showValues:!0,duration:500,xAxis:{showMaxMin:!1},yAxis:{axisLabel:"Value",tickFormat:function(a){return d3.format(",.2f")(a)}}}}}}}])}(),angular.module("polar.components.analytics.measurement",["polar.util","polar.data"]),function(){angular.module("polar.components.analytics.measurement").service("polar.components.analytics.measurement.$HistModal",["$uibModal",function(a){var b=function(){};return b.open=function(b){return a.open({animation:!0,templateUrl:"app/scripts/components/analytics/measurement/hist_modal_template.html",controller:"polar.util.controllers.modal.Controller",size:"md",resolve:{data:function(){return{unit:b.unit,filters:b.filters}}}}).result},b}])}(),function(){var a=angular.module("polar.components.analytics.measurement");a.controller("polar.components.analytics.measurement.HistController",["$scope","polar.data.Measurement","polar.util.services.StateHandler","$timeout",function(a,b,c,d){function e(){a.state=c.getInstance(),a.state.initiate(),b.fetchDistribution(a.unit,a.filters).then(function(b){a.state.success();var c=_.chain(b).map(h).flatten().value(),d=_.max(c),e=_.map(c,function(a){return a/d});a.data=[{key:a.unit,values:g(e,d)}]},function(){a.state.fatal()}),a.list=[],a.init=e}function f(b){if(!(b.values.length<10)){var c=_.map(b.values,function(a){return b.nf*a}),d=_.max(c),e=_.map(c,function(a){return a/d});a.data=[{key:a.unit,values:g(e,d)}]}}function g(a,b){var c=d3.layout.histogram().bins(10).range([0,1])(a),d=_.map(c,function(a,c){return vList=_.chain(a).map(function(a){return parseFloat((a*b).toFixed(2))}).sortBy().value(),{label:"B"+(c+1),x:a.x,dx:a.dx,nf:b,range:(a.x*b).toFixed(2)+"-"+((a.x+a.dx)*b).toFixed(2),value:parseInt(a.length),values:a,avg:_.chain(vList).reduce(function(a,b){return a+b},0).value()/vList.length,list:_.chain(vList).unique().value()}});return d}function h(a){return _.chain(a.hits.hits).map(function(a){return a.inner_hits.measurements.hits.hits}).flatten().pluck("_source").map(function(a){return a.parsedValue}).value()}a.$on("polar-measurement-histogram-redraw",function(b,c){f(c),a.$apply()}),a.$on("polar-measurement-histogram-mouseover",function(b,c){a.list=c.list,a.range=c.range,a.avg=c.avg,a.showMeta=!0,a.$apply()}),a.$on("polar-measurement-histogram-mouseout",function(b,c){a.showMeta=!1,a.$apply()}),e()}])}(),function(){var a=angular.module("polar.components.analytics.measurement");a.directive("polarAnalyticsMeasurementHistogram",[function(){return{scope:{unit:"=",filters:"="},replace:!0,templateUrl:"app/scripts/components/analytics/measurement/hist_template.html",controller:"polar.components.analytics.measurement.HistController",link:function(a,b,c){function d(b){b.on("elementMouseover.tooltip",function(b){a.$emit("polar-measurement-histogram-mouseover",b.data)}),b.on("elementMouseout.tooltip",function(b){a.$emit("polar-measurement-histogram-mouseout",b.data)}),b.on("elementClick.tooltip",function(b){a.$emit("polar-measurement-histogram-redraw",b.data)})}a.options={chart:{type:"discreteBarChart",height:450,margin:{top:20,right:20,bottom:50,left:55},x:function(a){return a.label},y:function(a){return a.value},showValues:!0,duration:500,xAxis:{axisLabel:"Buckets"},yAxis:{axisLabel:"Frequency",axisLabelDistance:-10},callback:function(a){d(a.discretebar.dispatch),console.log()}}}}}}])}(),function(){var a=angular.module("polar.components.analytics.measurement");a.controller("polar.components.analytics.measurement.Controller",["$scope","polar.data.Document","polar.components.filter.$FilterParser","polar.util.services.StateHandler","polar.data.Measurement","$q","polar.components.analytics.measurement.$HistModal",function(a,b,c,d,e,f,g){function h(){a.state=d.getInstance(!1,!0),a.openHistogram=k,i().then(j)}function i(){var b=d.getInstance();return b.initiate(),e.fetchRawMeasurements().then(function(c){b.success(),c=_.filter(c,function(a){return a.group}),a.validMeasurements=_.pluck(c,"name"),a.validMeasurementsObjects=c},function(){b.fatal("Unable to fetch valid measurements")})}function j(){a.state.initiate(),b.aggregateByMeasurements(c(a.filters)).then(function(b){a.data=_.chain(b.aggregations.entities.entity_name.buckets).map(function(a){return{unit:a.key,count:a.doc_count,min:a.entity_stats.min,max:a.entity_stats.max,avg:a.entity_stats.avg}}).filter(function(b){return _.contains(a.validMeasurements,b.unit)}).map(function(b){return b.type=a.validMeasurementsObjects[_.indexOf(a.validMeasurements,b.unit)].group,b}).value(),a.types=_.chain(a.data).pluck("type").unique().value(),a.filteredType=a.types[0],a.state.success()},function(){a.state.fatal()})}function k(b){g.open({unit:b,filters:a.filters})}h(),a.$on("polar.components.analytics.reloadData.Measurement",function(a,b){j()})}])}(),function(){var a=angular.module("polar.components.analytics.measurement");a.directive("polarAnalyticsMeasurement",[function(){return{scope:{filters:"="},replace:!0,templateUrl:"app/scripts/components/analytics/measurement/template.html",controller:"polar.components.analytics.measurement.Controller",link:function(a,b,c){}}}])}(),angular.module("polar.components.analytics",["polar.util","polar.data","polar.components.analytics.timeVariance","polar.components.analytics.measurement","polar.components.analytics.geoDistribution","polar.components.analytics.concept","polar.components.analytics.geoDiversity","polar.components.analytics.popularEntities","polar.components.analytics.stats","polar.components.filter"]),function(){var a=angular.module("polar.components.analytics");a.controller("polar.components.analytics.Controller",["$scope",function(a){function b(){a.loadData=c}var c=function(){var b;switch(a.active){case 0:b="polar.components.analytics.reloadData.Time";break;case 1:b="polar.components.analytics.reloadData.Geo";break;case 2:b="polar.components.analytics.reloadData.Concept";break;case 3:b="polar.components.analytics.reloadData.Measurement";break;case 4:b="polar.components.analytics.reloadData.GeoDiversity";break;case 5:b="polar.components.analytics.reloadData.PopularEntities";break;case 6:b="polar.components.analytics.reloadData.Stats"}a.$broadcast(b)};b()}])}(),function(){var a=angular.module("polar.components.analytics");a.directive("polarAnalytics",["$location","$timeout",function(a,b){return{scope:{filters:"="},replace:!0,templateUrl:"app/scripts/components/analytics/template.html",controller:"polar.components.analytics.Controller",link:function(a,c,d){a.initTab=d.startTab;var e={Time:0,Geo:1,Concept:2,Measurement:3,GeoDiversity:4,PopularEntities:5,Stats:6};b(function(){a.active=e[a.initTab]||6},500),a.fullScreen=function(){$(".query-result").requestFullScreen()}}}}])}(),angular.module("polar.components",["c.components.flash","polar.components.navigation","polar.components.footer","polar.components.conceptEditor","polar.components.addFilter","polar.components.filter","polar.components.analytics","polar.components.configuration","polar.components.measurementEditor"]),angular.module("tg.graph.aside",[]),function(){var a=angular.module("tg.graph.aside");a.controller("tg.graph.aside.Controller",["$scope","$rootScope","$timeout",function(a,b,c){function d(){b.$on("tg.events.graph.aside.open",function(b,c){a.element=c,a.show=!0,a.$apply()}),b.$on("tg.events.graph.aside.close",function(b,c){a.show=!1,a.$apply()}),b.$on("tg.events.graph.aside.refresh",function(b,c){a.show&&(a.element=c),a.$apply()}),a.close=e}function e(){a.show=!1}d()}])}(),function(){var a=angular.module("tg.graph.aside");a.directive("tgGraphAside",[function(){return{scope:{},replace:!0,templateUrl:"app/scripts/components/graph/aside/template.html",controller:"tg.graph.aside.Controller"}}])}(),function(){angular.module("tg.graph.aside").factory("tg.graph.aside.$aside",["$rootScope",function(a){function b(){}return b.open=function(b){a.$broadcast("tg.events.graph.aside.open",b)},b.close=function(b){a.$broadcast("tg.events.graph.aside.open")},b.refresh=function(b){a.$broadcast("tg.events.graph.aside.refresh",b)},b.open,b}])}(),angular.module("tg.graph",["tg.graph.aside"]),angular.module("tg.graph").factory("Visualizer",function(){var a=gViz;return a.setup({defaultType:"Unknown",vertextIdentifier:"id",typeIdentifier:"type"}),a.configure({classes:{Simple:{display:"name"},Derived:{display:"name"},Group:{display:"name"}}}),a}),angular.module("tg.graph").directive("tgGraph",["Visualizer",function(a){return{restrict:"A",scope:{behavior:"=?",configration:"=",stream:"=",metadata:"&",nodeMenu:"&",edgeMenu:"&",onLoad:"&",helpers:"=?"},link:function(b,c,d){function e(){b.graph=a.Engine.create(c[0],b.configration,b.metadata(),b.nodeMenu(),b.edgeMenu()),b.graph.data([]).draw(),b.onLoad&&b.onLoad({graph:b.graph})}b.helpers={fullScreen:function(){b.graph.fullScreen(c[0])}},e(),b.$watch("behavior",function(c,d){c&&b.graph&&(a.setup(c),b.graph.redraw())},!0)}}}]),angular.module("polar.sections",[]),angular.module("polar",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","LocalStorageModule","polar.components","polar.data","polar.sections","polar.util","ui.bootstrap","ui.sortable"]).config(["$routeProvider",function(a){var b={config:["polar.data.Config","$q","$location",function(a,b,c){var d=b.defer();return a.isSet()?d.resolve():(c.path("/config"),d.reject()),d.resolve(),d.promise}],ontology:["polar.data.ConceptFactory","$q","$location",function(a,b,c){var d=b.defer();return a.isSet()?d.resolve():(c.path("/config"),d.reject()),d.resolve(),d.promise}]};a.when("/concept_editor",{templateUrl:"app/scripts/sections/home/concept_editor.html",controller:"polar.util.controllers.StaticPageController",resolve:{configration:b.config}}).when("/query",{templateUrl:"app/scripts/sections/home/query.html",controller:"polar.util.controllers.StaticPageController",resolve:{configration:b.config,ontology:b.ontology}}).when("/query/:type",{templateUrl:"app/scripts/sections/home/query.html",controller:"polar.util.controllers.StaticPageController",resolve:{configration:b.config,ontology:b.ontology}}).when("/config",{templateUrl:"app/scripts/sections/home/config.html",controller:"polar.util.controllers.StaticPageController"}).when("/measurement_editor",{templateUrl:"app/scripts/sections/home/measurement_editor.html",controller:"polar.util.controllers.StaticPageController"}).otherwise({redirectTo:"/config"})}]).run(["polar.data.Config","polar.data.EntityCount",function(a,b){a.load(),b.fetch()}]),angular.module("polar").run(["$templateCache",function(a){"use strict";a.put("app/scripts/components/add_filter/modal_template.html",'<div>\n  <div class="modal-body">\n    <fieldset class="form-group">\n      <select class="form-control" placeholder="Filter Type" data-ng-model="filterType">\n        <option value="" disabled>-- Filter Type --</option>\n        <option value="geo">Geographic</option>\n        <option value="time">Date Range</option>\n        <option value="concept">Conceptual</option>\n        <option value="measurement">Measurement</option>\n        <option value="entity">Entity</option>\n        <option value="docType">File Type</option>\n      </select>\n     </fieldset>\n  </div>\n\n  <div class="modal-footer">\n    <button class="btn btn-info"\n            type="button"\n            data-ng-click="ok({ type: filterType })"\n            data-ng-disabled="!filterType">Add</button>\n  </div>\n</div>\n'),a.put("app/scripts/components/add_filter/template.html",'<button class="btn btn-primary" data-ng-click="addFilter()"><i class="fa fa-plus"></i></button>\n'),a.put("app/scripts/components/analytics/template.html",'<div>\n  <div class="row">\n    <div class="col-md-2 col-md-offset-10">\n      <div class="pull-right">\n        <div polar-add-filter data-filters="filters"></div>\n        <button class="btn btn-info" data-ng-click="filters = [ ]; loadData()"><i class="fa fa-refresh"></i></button>\n        <button class="btn btn-warning" data-ng-click="loadData()"><i class="fa fa-search"></i></button>\n        <button class="btn btn-info" data-ng-click="fullScreen()"><i class="fa fa-arrows-alt"></i></button>\n      </div>\n    </div>\n  </div>\n\n  <div class="row">\n    <div class="col-md-12 query-result">\n\n       <uib-tabset active="active">\n        <uib-tab index="6" heading="Stats"  select="active = 6">\n          <div polar-analytics-stats  class="query-result-view" data-filters="filters" data-ng-if="active == 6"></div>\n        </uib-tab>\n\n        <uib-tab index="0" heading="Date Distribution" select="active = 0">\n          <div polar-analytics-time-variance class="query-result-view" data-filters="filters" data-ng-if="active == 0"></div>\n        </uib-tab>\n\n        <uib-tab index="1" heading="Geographic Distribution" select="active = 1">\n          <div polar-analytics-geo-distribution  class="query-result-view" data-filters="filters" data-ng-if="active == 1"></div>\n        </uib-tab>\n\n        <uib-tab index="2" heading="Concept Correlation" select="active = 2">\n          <div polar-analytics-concept  class="query-result-view" data-filters="filters" data-ng-if="active == 2"></div>\n        </uib-tab>\n\n        <uib-tab index="5" heading="Popular Entities"  select="active = 5">\n          <div polar-analytics-popular-entities  class="query-result-view" data-filters="filters" data-ng-if="active == 5"></div>\n        </uib-tab>\n\n        <uib-tab index="3" heading="Measurement Distribution"  select="active = 3">\n          <div polar-analytics-measurement  class="query-result-view" data-filters="filters" data-ng-if="active == 3"></div>\n        </uib-tab>\n\n        <uib-tab index="4" heading="Regions of interest"  select="active = 4">\n          <div polar-analytics-geo-diversity  class="query-result-view" data-filters="filters" data-ng-if="active == 4"></div>\n        </uib-tab>\n      </uib-tabset>\n\n    </div>\n  </div>\n</div>\n'),
a.put("app/scripts/components/concept_editor/template.html",'<div>\n  <div class="row">\n    <div class="col-md-12">\n      <div class="graph-container"\n           tg-graph\n           graph="graph"\n           on-load="onGraphLoad(graph)"\n           edge-menu="edgeMenu"\n           node-menu="nodeMenu"\n           metadata="metadata"\n           configration="configration"\n           behavior="behavior"\n           stream="stream"\n           helpers="helpers"></div>\n    </div>\n  </div>\n\n  <div class="row">\n    <div class="col-md-12">\n      <div class="graph-panel">\n        <button class="btn btn-primary" data-ng-click="addConcept()">\n          <i class="fa fa-plus"></i>\n        </button>\n\n        <button class="btn btn-info" data-ng-click="saveLocally()">\n          <i class="fa fa-floppy-o"></i>\n        </button>\n\n        <!-- TODO: enable users to set a name while uploading -->\n        <button class="btn btn-warning"  data-ng-click="upload()" data-ng-disabled="true">\n          <i class="fa fa-cloud-upload"></i>\n        </button>\n\n        <a href="#/config" class="btn btn-warning">\n          <i class="fa fa-cloud-download"></i>\n        </a>\n\n        <button class="btn btn-success" data-ng-click="export()">\n          <i class="fa fa-external-link"></i>\n        </button>\n\n        <button class="btn btn-secondary pull-right" data-ng-click="helpers.fullScreen()">\n          <i class="fa fa-arrows-alt"></i>\n        </button>\n      </div>\n    </div>\n  </div>\n</div>\n'),a.put("app/scripts/components/configuration/template.html",'<div>\n  <div class="row">\n    <div class="col-md-12">\n      <h3>\n        Application configuration\n        <span class="badge" data-ng-show="!(isConfigSet() && isOntologySet())">Incomplete</span>\n        <span class="badge" data-ng-show="isConfigSet() && isOntologySet()">Complete</span>\n      </h3>\n      <button class="btn btn-primary" data-ng-click="loadDefault()">Load Default</button>\n      <hr />\n    </div>\n  </div>\n\n\n  <div class="row">\n    <div class="col-md-6">\n      <table class="table">\n        <thead>\n          <tr>\n            <th>Field</th>\n            <th>Value</th>\n          </tr>\n        </thead>\n\n\n        <tbody>\n          <tr>\n            <td>Elastic search endpoint</td>\n            <td><input class="form-control" data-ng-model="config.endpoint" placeholder="http://mydomain/elasticsearch" /></td>\n          </tr>\n\n          <tr>\n            <td>Elastic search extraction index</td>\n            <td><input class="form-control" data-ng-model="config.index" placeholder="polar-deep-insights" /></td>\n          </tr>\n\n          <tr>\n            <td>Elastic search extraction doc-type</td>\n            <td><input class="form-control" data-ng-model="config.docType" placeholder="docs" /></td>\n          </tr>\n\n          <tr>\n            <td>Elastic search measurements index</td>\n            <td><input class="form-control" data-ng-model="config.measurementIndex" placeholder="polar-measurements" /></td>\n          </tr>\n\n          <tr>\n            <td>Elastic search measurements doc-type</td>\n            <td><input class="form-control" data-ng-model="config.measurementDocType" placeholder="raw-measurements" /></td>\n          </tr>\n\n          <tr>\n            <td>Entity Count JSON path</td>\n            <td><input class="form-control" data-ng-model="config.entityCountPath" placeholder="http://mydomain/entitiy-count.json" /></td>\n          </tr>\n\n          <tr>\n            <td>Sweet ontology path</td>\n            <td><input class="form-control" data-ng-model="config.sweetOntologyPath" placeholder="http://mydomain/sweet.json" /></td>\n          </tr>\n\n          <tr>\n            <td colspan="2">\n              <button class="btn btn-success" data-ng-click="saveConfig(config)">Save</button>\n            </td>\n          </tr>\n\n        </tbody>\n      </table>\n    </div>\n\n    <div class="col-md-6">\n      <p>\n        A concept ontology is required for this application to function.\n\n        You can <a href="#/concept_editor">create</a> your own ontology or\n        download a predefined ontology from your elasticsearch index.\n      </p>\n\n      <p>\n        <i class="text-danger" data-ng-show="!isOntologySet()">\n          A concept ontology has not been setup yet.\n        </i>\n      </p>\n\n      <button class="btn btn-warning" data-ng-click="downloadOntology()">Download</button>\n\n      <hr />\n\n      <p>\n        The analytics interface requires additional precomputed information (ie)\n        document counts per-entity.\n      </p>\n\n      <p>\n        <i class="text-danger" data-ng-show="!entityCountSet">\n          This has not been setup yet\n        </i>\n      </p>\n\n      <button class="btn btn-info" data-ng-click="downloadEntityCount()" data-ng-disabled="!config.entityCountPath">Download</button>\n\n      <hr />\n\n      You can Curate extracted measurements <a href="#/measurement_editor">here</a>.\n    </div>\n  </div>\n</div>\n'),a.put("app/scripts/components/filter/edit_modal_template.html",'<div>\n  <div class="modal-body">\n    <div class="row">\n      <div class="col-md-12">\n        <div polar-filter-geo data-filter="data.filter" data-ng-if="data.filter.type == \'geo\'"></div>\n\n        <div polar-filter-time data-filter="data.filter" data-ng-if="data.filter.type == \'time\'"></div>\n\n        <div polar-filter-concept data-filter="data.filter" data-ng-if="data.filter.type == \'concept\'"></div>\n\n        <div polar-filter-measurement data-filter="data.filter" data-ng-if="data.filter.type == \'measurement\'"></div>\n\n        <div polar-filter-entity data-filter="data.filter" data-ng-if="data.filter.type == \'entity\'"></div>\n\n        <div polar-filter-doc-type data-filter="data.filter" data-ng-if="data.filter.type == \'docType\'"></div>\n      </div>\n    </div>\n\n  </div>\n\n  <div class="modal-footer">\n    <button class="btn btn-info"\n            type="button"\n            data-ng-click="ok(data.filter)">Save</button>\n  </div>\n</div>\n'),a.put("app/scripts/components/filter/template.html","<div>\n  <div class=\"panel bounceInLeft animated\" data-ng-class=\"{\n    'panel-success' : (filter.type == 'geo'),\n    'panel-info' : (filter.type == 'time'),\n    'panel-warning' : (filter.type == 'concept'),\n    'panel-danger' : (filter.type == 'measurement'),\n  }\">\n    <div class=\"panel-heading\">\n      <h3 class=\"panel-title\">\n        <span data-ng-show=\"filter.type == 'geo'\">Geographic</span>\n        <span data-ng-show=\"filter.type == 'time'\">Date Range</span>\n        <span data-ng-show=\"filter.type == 'concept'\">Concept</span>\n        <span data-ng-show=\"filter.type == 'measurement'\">Measurement</span>\n        <span data-ng-show=\"filter.type == 'entity'\">Entity</span>\n        <span data-ng-show=\"filter.type == 'docType'\">File Type</span>\n\n        <span class=\"pull-right\">\n"+'          <button class="btn btn-xs btn-default" data-ng-click="edit(filter)"><i class="fa fa-pencil"></i></button>\n          &nbsp;\n          <button class="btn btn-xs btn-default" data-ng-click="onDelete(filter)"><i class="fa fa-times"></i></button>\n        </span>\n      </h3>\n    </div>\n    <div class="panel-body">\n      <span data-ng-show="filter.type == \'geo\'">\n        <i data-ng-show="!filter.regions || filter.regions.length == 0">\n          Add filter specifications\n        </i>\n\n        <span data-ng-show="filter.regions.length > 0">\n          {{ filter.regions.length }} region(s)\n        </span>\n      </span>\n\n      <span data-ng-show="filter.type == \'time\'">\n        <i data-ng-show="!filter.timeRanges || filter.timeRanges.length == 0">\n          Add filter specifications\n        </i>\n\n        <span data-ng-show="filter.timeRanges.length > 0">\n          {{ filter.timeRanges.length }} time range(s)\n        </span>\n      </span>\n\n      <span data-ng-show="filter.type == \'concept\'">\n        <i data-ng-show="!filter.factory || filter.factory.concepts.length == 0">\n          Add filter specifications\n        </i>\n\n        <span data-ng-show="filter.factory.concepts.length > 0">\n          {{ filter.factory.concepts.length }} concept(s)\n        </span>\n      </span>\n\n      <span data-ng-show="filter.type == \'measurement\'">\n        <i data-ng-show="!filter.measurements || filter.measurements.length == 0">\n          Add filter specifications\n        </i>\n\n        <span data-ng-show="filter.measurements.length > 0">\n          {{ filter.measurements.length }} measurement(s)\n        </span>\n      </span>\n\n      <span data-ng-show="filter.type == \'entity\'">\n        <i data-ng-show="!filter.entities || filter.entities.length == 0">\n          Add filter specifications\n        </i>\n\n        <span data-ng-show="filter.entities.length > 0">\n          {{ filter.entities.length }} entity(s)\n        </span>\n      </span>\n\n      <span data-ng-show="filter.type == \'docType\'">\n        <i data-ng-show="!filter.docTypes || filter.docTypes.length == 0">\n          Add filter specifications\n        </i>\n\n        <span data-ng-show="filter.docTypes.length > 0">\n          {{ filter.docTypes.length }} document type(s)\n        </span>\n      </span>\n\n    </div>\n  </div>\n</div>\n'),a.put("app/scripts/components/flash/template.html",'<div>\n  <div class="c-alert c-{{flashConfig.type || \'info\'}}" data-ng-if="(flashConfig && !closeFlash)">\n    <span class="glyphicon c-{{flashConfig.type || \'info\'}}-icon"></span>\n    <span class="body" data-ng-bind="flashConfig.message"></span>\n    <button type="button" class="close" data-ng-click="close()" aria-hidden="true">&times;</button>\n  </div>\n</div>\n'),a.put("app/scripts/components/footer/template.html",'<div class="footer">\n  <span>\n    <a href="https://github.com/USCDataScience/polar-deep-insights" target="_blank">Github</a>&nbsp;.&nbsp;\n    <a href="https://github.com/USCDataScience/polar-deep-insights/wiki/pages" target="_blank">Wiki</a>\n  </span>\n  <span class="pull-right">\n    <span class="glyphicon glyphicon-heart"></span> from <a href="http://irds.usc.edu" target="_blank">IRDS.USC.EDU</a>\n  </span>\n</div>\n'),a.put("app/scripts/components/measurement_editor/template.html",'<div>\n  <div class="row">\n    <div class="col-md-12">\n      <h3>Extracted Measurements</h3>\n\n      <button class="btn btn-success" data-ng-click="save()">Save</button>&nbsp;\n      <button class="btn btn-info" data-ng-click="download()">Download</button>\n      <button class="btn btn-warning" data-ng-click="upload()" data-ng-disabled="true">Upload</button>\n    </div>\n  </div>\n\n  <hr />\n\n  <div class="row">\n    <div class="col-md-4">\n      <div class="list-group measurements-container source" ui-sortable="sortableOptions" data-ng-model="measurements" style="height: 650px; overflow-y: scroll;">\n        <a class="list-group-item measurements"\n           data-ng-repeat="m in measurements"\n           style="padding:5px;">\n            <span data-ng-bind="m.name" data-ng-click="showDistribution(m.name)" class="link"></span>\n            <span class="pull-right">\n              <span data-ng-bind="m.count" class="badge"></span>\n              <i class="fa fa-times" data-ng-click="measurements.splice($index, 1)"></i>\n              &nbsp;&nbsp;\n            </span>\n        </a>\n      </div>\n    </div>\n\n    <div class="col-md-4">\n      <div class="row">\n        <div class="col-md-9">\n          <div class="form-group">\n            <input class="form-control" placeholder="Group Name" data-ng-model="groupName"/>\n          </div>\n        </div>\n\n        <div class="col-md-3">\n          <div class="form-group">\n            <button class="btn btn-primary" data-ng-click="addGroup(groupName)">Add</button>\n          </div>\n        </div>\n      </div>\n\n      <div class="row">\n        <div class="col-md-12">\n          <table class="table table-bodered">\n            <thead>\n              <tr><th>Name</th><th>#</th></tr>\n            </thead>\n            <tbody>\n              <tr data-ng-show="!groups || groups.length == 0">\n                <td colspan="2"><i class="text-warning">No groups</i></td>\n              </tr>\n\n              <tr data-ng-repeat="g in groups" data-ng-class="{\'success\' : (selectedGroup == $index) }" data-ng-click="selectGroup($index)">\n                <td data-ng-bind="g"></td>\n                <td><a class="text-danger" data-ng-click="removeGroup($index)"><i class="fa fa-times"></i></a></td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </div>\n    </div>\n    <div class="col-md-4 well measurements-container target"\n         data-ng-if="groups[selectedGroup]"\n         ui-sortable="sortableOptions" ng-model="allMeasurements[groups[selectedGroup]]"\n         style="height: 650px; overflow-y: scroll;">\n      <a class="list-group-item measurements"\n         data-ng-repeat="m in allMeasurements[groups[selectedGroup]]"\n         style="padding:5px;">\n        <span data-ng-bind="m.name" data-ng-click="showDistribution(m.name)" class="link"></span>\n      </a>\n    </div>\n  </div>\n</div>\n'),a.put("app/scripts/components/navigation/template.html",'<nav class="navbar navbar-default">\n  <div class="container">\n    <div class="navbar-header">\n      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbarLinks">\n        <span class="sr-only">Toggle navigation</span>\n        <span class="icon-bar"></span>\n        <span class="icon-bar"></span>\n        <span class="icon-bar"></span>\n      </button>\n      <a class="navbar-brand" href="#/">Polar Deep Insights</a>\n    </div>\n\n    <div class="collapse navbar-collapse navbar-collapse" id="navbarLinks">\n      <ul class="nav navbar-nav">\n\n      </ul>\n\n\n      <ul class="nav navbar-nav navbar-right">\n        <li data-ng-class="$location.path() == \'/concept_editor\' ? \'active\' : \'\' "><a href="#/concept_editor">Concept Editor</a></li>\n        <li data-ng-class="$location.path() == \'/query\' ? \'active\' : \'\' "><a href="#/query">Query Interface</a></li>\n        <li data-ng-class="$location.path() == \'/config\' ? \'active\' : \'\' "><a href="#/config">Configure</a></li>\n      </ul>\n    </div>\n\n  </div>\n</nav>\n'),a.put("app/scripts/components/analytics/concept/template.html",'<div>\n  <div class="row">\n    <div class="col-md-2">\n      <div class="btn-group" role="group" data-ng-init="view = \'chart\'">\n        <button type="button"\n                class="btn btn-info"\n                data-ng-disabled="view == \'chart\'"\n                data-ng-click="view = \'chart\'">Chart</button>\n        <button type="button"\n                class="btn btn-info"\n                data-ng-disabled="view == \'graph\'"\n                data-ng-click="view = \'graph\'">Graph</button>\n      </div>\n    </div>\n    <div class="col-md-4">\n        <rzslider rz-slider-model="nResults"\n            rz-slider-options="{ \'floor\': 0, \'ceil\': 500, \'step\': 1 }"></rzslider>\n    </div>\n\n    <div class="col-md-2">\n        <rzslider rz-slider-model="inferenceBound"\n            rz-slider-options="{ \'floor\': 2, \'ceil\': 10, \'step\': 1 }"></rzslider>\n    </div>\n    <div class="col-md-4">\n      <div polar-analytics-filter data-field="field" data-fn="fn"></div>\n    </div>\n  </div>\n\n  <div class="row" data-ng-if="view == \'chart\'">\n    <div class="col-md-12">\n      <nvd3 options="options" data="data" api="api.api"></nvd3>\n    </div>\n  </div>\n\n  <div class="row" data-ng-if="view == \'graph\'">\n    <div class="col-md-12">\n      <div class="graph-container"\n           tg-graph\n           graph="graph"\n           on-load="onGraphLoad(graph)"\n           edge-menu="edgeMenu"\n           node-menu="nodeMenu"\n           metadata="metadata"\n           configration="configration"\n           behavior="behavior"\n           stream="stream"\n           helpers="helpers"></div>\n    </div>\n  </div>\n\n  <div class="row" data-ng-if="infered.length > 0">\n    <div class="col-md-6">\n      <h4>Semantic inference</h4>\n\n      <table class="table table-bordered">\n        <thead>\n          <tr><th>Inferred</th></tr>\n        </thead>\n        <tr data-ng-repeat="i in infered">\n          <td data-ng-bind="i"></td>\n        </tr>\n      </table>\n    </div>\n  </div>\n</div>\n'),a.put("app/scripts/components/analytics/filter/template.html",'<div>\n  <div class="row">\n    <div class="col-md-6">\n      <div class="form-group">\n        <select class="form-control" placeholder="FIELD" data-ng-model="field" data-ng-init="field=\'count\'">\n          <option value="count">Entity Count</option>\n          <option value="tf">Term Frequency</option>\n          <option value="tf-alpha">Term Occurrence Frequency</option>\n          <option value="tf-idf">TF-IDF</option>\n        </select>\n      </div>\n    </div>\n\n    <div class="col-md-6">\n      <div class="form-group">\n        <select class="form-control"\n                placeholder="OPERATION"\n                data-ng-model="fn"\n                data-ng-init="fn=\'sum\'"\n                data-ng-disabled="field == \'tf-idf\'">\n          <option value="count">Document Count</option>\n          <option value="sum">Sum</option>\n          <option value="avg">Average</option>\n          <option value="max">Maximum</option>\n          <option value="min">Minimum</option>\n        </select>\n      </div>\n    </div>\n  </div>\n</div>\n'),a.put("app/scripts/components/analytics/geo_distribution/template.html",'<div>\n  <div class="row" data-ng-init="slider = { \'value\': 100 , \'scale\': 100 }">\n    <div class="col-md-5">\n      <rzslider rz-slider-model="slider.value" rz-slider-options="{ \'floor\': 1, \'ceil\': 10000 }"></rzslider>\n    </div>\n\n    <div class="col-md-3">\n      <rzslider rz-slider-model="slider.scale" rz-slider-options="{ \'floor\': 1, \'ceil\': 100 }"></rzslider>\n    </div>\n\n    <div class="col-md-4">\n      <div polar-analytics-filter data-field="field" data-fn="fn"></div>\n    </div>\n  </div>\n\n  <div class="row" class="idf-location-cont">\n    <div class="col-md-12">\n      <div class="idf-location"></div>\n    </div>\n  </div>\n\n</div>\n'),a.put("app/scripts/components/analytics/geo_diversity/template.html",'<div>\n  <div class="row" class="idf-location-cont">\n    <div class="col-md-12">\n      <leaflet defaults="options" maxbounds="options.maxBounds" lf-center="center"  layers="layers"  markers="map.markers" event-broadcast="events" height="640px" width="100%"></leaflet>\n    </div>\n  </div>\n</div>\n'),a.put("app/scripts/components/analytics/measurement/hist_modal_template.html",'<div>\n  <div class="modal-body">\n    <div polar-analytics-measurement-histogram data-unit="data.unit" data-filters="data.filters"></div>\n  </div>\n\n  <div class="modal-footer">\n    <button class="btn btn-info"\n            data-ng-click="ok()"\n            type="button">Close</button>\n  </div>\n</div>\n'),a.put("app/scripts/components/analytics/measurement/hist_template.html",'<div>\n  <div class="row">\n    <div class="col-md-4 col-md-offset-8">\n      <div class="pull-right">\n        <button data-ng-click="init()" class="btn btn-info btn-xs">Refresh</button>\n      </div>\n    </div>\n  </div>\n\n  <div class="row">\n    <div class="col-md-12">\n      <nvd3 options="options" data="data"></nvd3>\n    </div>\n  </div>\n\n  <div class="row" data-ng-show="list.length > 0" data-ng-show="showMeta">\n    <div class="col-md-12" style="white-space: pre-line;word-wrap: break-word;">\n      <p>\n        <span><b>BUCKET RANGE : </b> {{ range }}</span>\n        <span><b>BUCKET Average : </b> {{ avg }}</span>\n        <span><b>BUCKET VALUES : </b> {{ list.join(\', \') }}</span>\n      </p>\n    </div>\n  </div>\n</div>\n'),a.put("app/scripts/components/analytics/measurement/template.html",'<div>\n  <div class="row">\n    <div class="col-md-6">\n      <div class="form-group">\n        <select class="form-control" data-ng-model="filteredType" data-ng-options="t for t in types">\n        </select>\n      </div>\n    </div>\n  </div>\n\n  <div class="row">\n    <div class="col-md-12">\n      <table class="table table-striped table-bordered">\n        <thead>\n          <tr>\n            <th>Unit</th>\n            <th>Type</th>\n            <th>DocCount</th>\n            <th>Min</th>\n            <th>Max</th>\n            <th>Average</th>\n          </tr>\n        </thead>\n\n        <tbody>\n          <tr data-ng-repeat="d in data | filter:filteredType">\n            <td><a data-ng-bind="d.unit" data-ng-click="openHistogram(d.unit)"></a></td>\n            <td data-ng-bind="d.type"></td>\n            <td data-ng-bind="d.count"></td>\n            <td data-ng-bind="d.min | number:2"></td>\n            <td data-ng-bind="d.max | number:2"></td>\n            <td data-ng-bind="d.avg | number:2"></td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n  </div>\n\n</div>\n'),a.put("app/scripts/components/analytics/popular_entities/template.html",'<div>\n  <div class="row">\n    <div class="col-md-6">\n      <div class="form-group">\n        <select class="form-control" data-ng-model="eType" data-ng-init="eType = \'places\'">\n          <option value="places">Places</option>\n          <option value="organizations">Organizations</option>\n          <option value="people">People</option>\n          <option value="time">Times</option>\n          <option value="money">Money</option>\n          <option value="percentages">Percentages</option>\n        </select>\n      </div>\n    </div>\n\n    <div class="col-md-6">\n      <div polar-analytics-filter data-field="field" data-fn="fn"></div>\n    </div>\n  </div>\n\n  <div class="row">\n    <div class="col-md-12">\n      <nvd3 options="options" data="data"></nvd3>\n    </div>\n  </div>\n</div>\n'),a.put("app/scripts/components/analytics/stats/template.html",'<div>\n  <div class="row">\n    <div class="col-md-6">\n      <nvd3 options="typeOptions" data="typeData"></nvd3>\n    </div>\n\n    <div class="col-md-6">\n      <table class="table table-bordered">\n        <thead>\n          <tr>\n            <td></td>\n            <td>Max</td>\n            <td>Average</td>\n            <td>Sum (Bytes)</td>\n          </tr>\n        </thead>\n        <tbody>\n          <tr>\n            <th>Number of Documents</th>\n            <td colspan="3"><center data-ng-bind="docCount | number"></center></td>\n          </tr>\n\n          <tr>\n            <th>Extracted information size</th>\n            <td data-ng-bind="results.textSize.max| number"></td>\n            <td data-ng-bind="results.textSize.avg | number:2"></td>\n            <td data-ng-bind="results.textSize.sum| number"></td>\n          </tr>\n\n          <tr>\n            <th>File size</th>\n            <td data-ng-bind="results.fileSize.max| number"></td>\n            <td data-ng-bind="results.fileSize.avg | number:2"></td>\n            <td data-ng-bind="results.fileSize.sum| number"></td>\n          </tr>\n\n          <tr>\n            <th>Information Extracted ( Extracted size / File size )</th>\n            <td data-ng-bind="results.textSize.max / results.fileSize.max | number"></td>\n            <td data-ng-bind="results.textSize.avg / results.fileSize.avg | number:2"></td>\n            <td data-ng-bind="results.textSize.sum / results.fileSize.sum | number"></td>\n          </tr>\n\n          <tr>\n            <th>Metadata size</th>\n            <td data-ng-bind="results.metaSize.max / results.fileSize.max | number"></td>\n            <td data-ng-bind="results.metaSize.avg / results.fileSize.avg | number:2"></td>\n            <td data-ng-bind="results.metaSize.sum / results.fileSize.sum | number"></td>\n          </tr>\n\n          <tr>\n            <th>Metadata ratio ( Metadata size / File size )</th>\n            <td data-ng-bind="results.metaRatio.max| number"></td>\n            <td data-ng-bind="results.metaRatio.avg | number:2"></td>\n            <td data-ng-bind="results.metaRatio.sum| number"></td>\n          </tr>\n\n        </tbody>\n      </table>\n\n      <hr />\n\n      <nvd3 options="options" data="data"></nvd3>\n\n      <hr />\n\n      <select class="form-control" data-ng-model="sE" data-ng-init="sE = keys[0]" data-ng-options="k for k in keys"></select>\n\n      <table class="table table-striped">\n        <thead>\n          <tr>\n            <th>Type</th>\n            <th>Max</th>\n            <th>Average</th>\n            <th>Total</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr>\n            <td>Extracted terms</td>\n            <td data-ng-bind="results[sE + \'OC\'].max| number"></td>\n            <td data-ng-bind="results[sE + \'OC\'].avg | number:2"></td>\n            <td data-ng-bind="results[sE + \'OC\'].sum| number"></td>\n          </tr>\n          <tr>\n            <td>Distinct extracted terms</td>\n            <td data-ng-bind="results[sE + \'TC\'].max| number"></td>\n            <td data-ng-bind="results[sE + \'TC\'].avg | number:2"></td>\n            <td data-ng-bind="results[sE + \'TC\'].sum| number"></td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n  </div>\n</div>\n'),a.put("app/scripts/components/analytics/time_variance/template.html",'<div>\n\n  <div class="row">\n    <div class="col-md-6">\n      <rzslider rz-slider-model="r.min"\n                rz-slider-high="r.max"\n                rz-slider-options="{ \'floor\': 1900, \'ceil\': 2050, \'step\': 1 }"></rzslider>\n\n    </div>\n\n    <div class="col-md-6">\n      <div polar-analytics-filter data-field="field" data-fn="fn"></div>\n    </div>\n  </div>\n  <div class="row">\n    <div class="col-md-12">\n      <nvd3 options="options" data="data"></nvd3>\n    </div>\n  </div>\n</div>\n'),a.put("app/scripts/components/concept_editor/concept/modal_template.html",'<div>\n  <div class="modal-body">\n    <div polar-concept-box data-concept="data.concept"></div>\n  </div>\n\n  <div class="modal-footer">\n    <button class="btn btn-info"\n            type="button"\n            ng-click="ok(data.concept)"\n            data-ng-disabled="!data.concept.isValid()">Save</button>\n  </div>\n</div>\n'),a.put("app/scripts/components/concept_editor/concept/template.html",'<div>\n  <div class="row">\n    <div class="col-md-12">\n\n       <fieldset class="form-group">\n        <input class="form-control" placeholder="Concept Name" data-ng-model="concept.name">\n       </fieldset>\n\n       <fieldset class="form-group">\n        <select class="form-control" placeholder="Concept Type" data-ng-model="concept.type">\n          <option value="" disabled>-- Concept Type --</option>\n          <option value="meta">High Level</option>\n          <option value="basic">Low Level</option>\n        </select>\n       </fieldset>\n\n       <fieldset class="form-group">\n        <tags-input data-ng-model="concept.alias"\n                    data-min-length="1"\n                    replace-spaces-with-dashes="false"></tags-input>\n       </fieldset>\n    </div>\n  </div>\n</div>\n'),a.put("app/scripts/components/concept_editor/export/modal_template.html",'<div>\n  <div class="modal-body">\n    <div polar-concept-export data-factory="data.factory"></div>\n  </div>\n\n  <div class="modal-footer">\n    <button class="btn btn-info"\n            type="button"\n            ng-click="ok()">Close</button>\n  </div>\n</div>\n'),a.put("app/scripts/components/concept_editor/export/template.html",'<div>\n  <pre style="height: 500px; overflow-y: scroll;">{{ entityString }}</pre>\n</div>\n'),a.put("app/scripts/components/filter/concept/search_template.html",'<div>\n  <div class="row">\n    <div class="col-md-10">\n      <tags-input ng-model="sC"\n                  replace-spaces-with-dashes="false"\n                  data-add-from-autocomplete-only="true"\n                  placeholder="Search for a concept ..">\n        <auto-complete source="filterConcepts($query)" max-results-to-show="100">\n\n        </auto-complete>\n      </tags-input>\n    </div>\n\n    <div class="col-md-2">\n      <button class="btn btn-primary btn-block" data-ng-click="helpers.onConceptAdd(sC); sC=[]">Add</button>\n    </div>\n  </div>\n</div>\n'),a.put("app/scripts/components/filter/concept/template.html",'<div>\n  <div class="row">\n    <div class="col-md-12">\n      <div polar-filter-concept-search data-helpers="helpers"></div>\n    </div>\n  </div>\n\n  <div class="row">\n    <div class="col-md-12">\n      <div class="graph-container"\n           tg-graph\n           graph="graph"\n           on-load="onGraphLoad(graph)"\n           edge-menu="edgeMenu"\n           node-menu="nodeMenu"\n           metadata="{}"\n           configration="{}"\n           behavior="{}"\n           stream="stream"\n           helpers="{}"></div>\n    </div>\n  </div>\n\n</div>\n'),a.put("app/scripts/components/filter/doc_type/template.html",'<div>\n  <div class="row">\n    <div class="col-md-12">\n      <tags-input ng-model="sC"\n                  display-property="name"\n                  replace-spaces-with-dashes="false"\n                  data-add-from-autocomplete-only="true"\n                  data-min-length="1"\n                  placeholder="Search for a measurement">\n        <auto-complete source="filterTypes($query)"\n                       load-on-empty="true" load-on-focus="true" load-on-down-arrow="true"></auto-complete>\n      </tags-input>\n    </div>\n  </div>\n  <div class="row">\n    <div class="col-md-6">\n      <button class="btn btn-primary" data-ng-click="addType(sC); sC=[]">\n        Add File Type &nbsp;<i class="fa fa-plus"></i>\n      </button>\n    </div>\n  </div>\n\n  <hr />\n\n  <div class="row">\n    <div class="col-md-12">\n\n      <table class="table table-striped" data-ng-show="filter.docTypes.length > 0">\n        <thead>\n          <tr>\n            <th>File Type</th>\n            <th></th>\n          </tr>\n        </thead>\n\n        <tbody>\n          <tr data-ng-repeat="g in filter.docTypes">\n            <td data-ng-bind="g.name"></td>\n            <td class="cursor text-danger" data-ng-click="filter.docTypes.splice($index, 1)"><i class="fa fa-times"></i></td>\n          </tr>\n        </tbody>\n      </table>\n\n\n    </div>\n  </div>\n</div>\n'),a.put("app/scripts/components/filter/entity/template.html",'<div>\n  <div class="row">\n    <div class="col-md-6">\n      <select class="form-control" data-ng-model="type" data-ng-init="type = \'places\'">\n        <option value="places">Places</option>\n        <option value="organizations">Organizations</option>\n        <option value="people">People</option>\n        <option value="time">Times</option>\n        <option value="money">Money</option>\n        <option value="percentages">Percentages</option>\n      </select>\n    </div>\n\n    <div class="col-md-6">\n      <tags-input ng-model="sC"\n                  display-property="name"\n                  replace-spaces-with-dashes="false"\n                  data-add-from-autocomplete-only="true"\n                  data-min-length="1"\n                  placeholder="Search for a measurement">\n        <auto-complete source="filterEntities($query)"\n                       load-on-empty="true" load-on-focus="true" load-on-down-arrow="true"></auto-complete>\n      </tags-input>\n    </div>\n  </div>\n  <div class="row">\n    <div class="col-md-6">\n      <button class="btn btn-primary" data-ng-click="addEntity(sC); sC=[]">\n        Add Entity &nbsp;<i class="fa fa-plus"></i>\n      </button>\n    </div>\n  </div>\n\n  <hr />\n\n  <div class="row">\n    <div class="col-md-12">\n\n      <table class="table table-striped" data-ng-show="filter.entities.length > 0">\n        <thead>\n          <tr>\n            <th>Entity</th>\n            <th>Type</th>\n            <th></th>\n          </tr>\n        </thead>\n\n        <tbody>\n          <tr data-ng-repeat="g in filter.entities">\n            <td data-ng-bind="g.name"></td>\n            <td data-ng-bind="g.type"></td>\n            <td class="cursor text-danger" data-ng-click="filter.entities.splice($index, 1)"><i class="fa fa-times"></i></td>\n          </tr>\n        </tbody>\n      </table>\n\n\n    </div>\n  </div>\n</div>\n'),
a.put("app/scripts/components/filter/geo/template.html",'<div>\n  <div class="row">\n    <div class="col-md-9">\n      <leaflet lf-center="map.center"\n           lf-draw="map.drawOptions" height="480px" width="100%">\n      </leaflet>\n    </div>\n\n    <div class="col-md-3" style="height: 480px; overflow-y:scroll;">\n      <p data-ng-show="filter.regions.length == 0">\n        <i>Draw a geographic bound</i>\n      </p>\n      <table class="table table-striped" data-ng-show="filter.regions.length > 0">\n        <thead>\n          <tr>\n            <th>Regions</th>\n            <th>Coordinates</th>\n            <th></th>\n          </tr>\n        </thead>\n\n        <tbody>\n          <tr data-ng-repeat="r in filter.regions">\n            <td data-ng-bind="r.name"></td>\n            <td>\n              <div data-ng-repeat="c in r.coords" data-ng-bind="c"></div>\n            </td>\n            <td class="cursor text-danger" data-ng-click="removeRegion($index)"><i class="fa fa-times"></i></td>\n          </tr>\n        </tbody>\n      </table>\n    </div>\n  </div>\n</div>\n'),a.put("app/scripts/components/filter/measurement/template.html",'<div>\n  <div class="row">\n    <div class="col-md-12">\n      <tags-input ng-model="sC"\n                  display-property="name"\n                  replace-spaces-with-dashes="false"\n                  data-add-from-autocomplete-only="true"\n                  data-min-length="1"\n                  placeholder="Search for a measurement">\n        <auto-complete source="filterMeasurements($query)"\n                       load-on-empty="true" load-on-focus="true" load-on-down-arrow="true"></auto-complete>\n      </tags-input>\n    </div>\n  </div>\n  <div class="row">\n    <div class="col-md-6">\n      <button class="btn btn-primary" data-ng-click="addFilter(sC); sC=[]">\n        Add Filter &nbsp;<i class="fa fa-plus"></i>\n      </button>\n    </div>\n  </div>\n\n  <hr />\n\n  <div class="row">\n    <div class="col-md-12">\n\n      <table class="table table-striped" data-ng-show="filter.measurements.length > 0">\n        <thead>\n          <tr>\n            <th>Measurement</th>\n            <th></th>\n          </tr>\n        </thead>\n\n        <tbody>\n          <tr data-ng-repeat="g in filter.measurements">\n            <td><a data-ng-bind="g.name" data-ng-click="openHist(g.name)"></a></td>\n            <td class="cursor text-danger" data-ng-click="filter.measurements.splice($index, 1)"><i class="fa fa-times"></i></td>\n          </tr>\n        </tbody>\n      </table>\n\n\n    </div>\n  </div>\n</div>\n'),a.put("app/scripts/components/filter/time/template.html",'<div>\n  <div class="row" data-ng-repeat="r in filter.timeRanges">\n    <div class="col-md-11">\n      <rzslider rz-slider-model="r.min"\n              rz-slider-high="r.max"\n              rz-slider-options="{ \'floor\': 1900, \'ceil\': 2050, \'step\': 1 }"></rzslider>\n    </div>\n\n    <div class="col-md-1 text-center">\n      <button class="btn btn-danger btn-xs" data-ng-click="filter.timeRanges.splice($index, 1)" style="margin-top:25px;">\n        <i class="fa fa-times"></i>\n      </button>\n    </div>\n  </div>\n\n  <div class="row">\n    <div class="col-md-6">\n      <button class="btn btn-primary" data-ng-click="addRange()">\n        Add Filter &nbsp;<i class="fa fa-plus"></i>\n      </button>\n    </div>\n  </div>\n</div>\n'),a.put("app/scripts/components/graph/aside/template.html",'<div class="aside" data-ng-class="show ? \'show\' : \'\'" style="z-index: 10000;">\n  <div class="aside-header">\n    <button class="close" ng-click="close()" type="button">×</button>\n    <h5 class="aside-title" data-ng-bind="element.id"></h5>\n  </div>\n\n  <div class="row">\n    <ul class="nav nav-pills nav-justified nav-pills-aside">\n      <li class="active"><a href="#"><i class="fa fa-bars"></i></a></li>\n    </ul>\n  </div>\n\n  <div class="row">\n    <h5 class="text-center title-tab">\n      Properties\n    </h5>\n  </div>\n\n  <div class="row aside-form">\n    <div class="col-md-12">\n      <form class="form-horizontal">\n\n        <div class="form-group element-fields"\n             data-ng-show="element.isVertex || element.isEdge"\n             data-ng-repeat="(key, value) in element.toJSON()">\n          <label class="col-md-6 control-label" data-ng-bind="key"></label>\n          <div class="col-md-6">\n            <p class="form-control-static" data-ng-bind="value"></p>\n          </div>\n        </div>\n\n      </form>\n    </div>\n  </div>\n</div>\n'),a.put("app/scripts/sections/home/concept_editor.html",'<div class="row">\n  <div class="col-md-12">\n    <div polar-concept-editor></div>\n  </div>\n</div>\n'),a.put("app/scripts/sections/home/config.html",'<div>\n\n  <div class="row">\n    <div class="col-md-12">\n      <div polar-configuration></div>\n    </div>\n  </div>\n\n</div>\n'),a.put("app/scripts/sections/home/measurement_editor.html",'<div>\n\n  <div class="row">\n    <div class="col-md-12">\n      <div polar-measurement-editor></div>\n    </div>\n  </div>\n\n</div>\n'),a.put("app/scripts/sections/home/query.html",'<div>\n  <div class="row" data-ng-init="filters = []" style="min-height: 105px;">\n    <div class="col-md-12">\n      <div class="row">\n        <div class="col-md-2" data-ng-repeat="f in filters">\n          <div polar-filter data-filter="f" data-on-delete="filters.splice($index, 1)"></div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div class="row">\n    <div class="col-md-12">\n      <div polar-analytics data-filters="filters" data-start-tab="{{params.type}}"></div>\n    </div>\n  </div>\n</div>\n'),a.put("app/scripts/util/templates/alert.html",'<div>\n  <div class="modal-body" data-ng-if="data.head">\n    {{ data.head }}\n  </div>\n\n  <div class="modal-body">\n    {{ data.message }}\n  </div>\n\n  <div class="modal-footer">\n    <button class="btn btn-info" type="button" ng-click="ok()">Ok</button>\n  </div>\n</div>\n'),a.put("app/scripts/util/templates/dialog.html",'<div>\n  <div class="modal-body" data-ng-if="data.head">\n    {{ data.head }}\n  </div>\n\n  <div class="modal-body">\n    {{ data.message }}\n  </div>\n\n  <div class="modal-footer">\n    <button class="btn btn-info" type="button" ng-click="ok()">Ok</button>\n    <button class="btn btn-danger" type="button" ng-click="cancel()">Cancel</button>\n  </div>\n</div>\n'),a.put("app/scripts/util/templates/global_loader.html",'<div>\n  <div>\n    <div class="c-global-loader" data-ng-if="loaderConfig">\n      <span data-ng-bind="loaderConfig.message"></span>\n    </div>\n\n    <div class="c-global-loader-center" data-ng-if="loaderConfig && heavyLoading">\n      <center>\n        <img src="images/loading.bd98618b.gif" style="height: 120px;margin-right: 20px;" />\n        <br />\n        Generating Insights\n      </center>\n    </div>\n  </div>\n</div>\n')}]);